2013-03-29 09:33:43,958 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 09:33:43,984 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 09:33:44,176 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 09:33:44,186 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:33:44,187 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 09:33:44,188 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 09:33:44,189 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 09:33:44,190 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:33:44,191 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:33:44,191 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:33:44,192 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:33:44,192 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 09:33:44,193 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 09:33:44,193 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 09:33:44,194 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 09:33:44,194 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 09:33:44,195 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 09:33:44,195 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:33:44,213 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test3953319583161724190.junit.dir\version-2 snapdir E:\test\test3953319583161724190.junit.dir\version-2
2013-03-29 09:33:44,226 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 09:33:44,232 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test3953319583161724190.junit.dir\version-2\snapshot.0
2013-03-29 09:33:44,256 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 09:33:44,258 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5055
2013-03-29 09:33:44,262 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:5055
2013-03-29 09:33:44,265 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 09:33:44,266 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5055 (no session established for client)
2013-03-29 09:33:44,266 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 09:33:44,271 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 09:33:44,272 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 09:33:44,272 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 09:33:44,272 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 09:33:44,273 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 09:33:44,281 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:33:44,281 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 09:33:44,282 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 09:33:44,282 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 09:33:44,283 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:33:44,283 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:33:44,284 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:33:44,286 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:33:44,286 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 09:33:44,287 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 09:33:44,287 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 09:33:44,288 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 09:33:44,288 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 09:33:44,288 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 09:33:44,289 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:33:44,291 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@6ab30eb5
2013-03-29 09:33:44,306 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:33:44,309 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:33:44,310 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5058
2013-03-29 09:33:44,310 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:33:44,312 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5058
2013-03-29 09:33:44,315 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 09:33:44,408 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c76daf0000 with negotiated timeout 30000 for client /127.0.0.1:5058
2013-03-29 09:33:44,409 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c76daf0000, negotiated timeout = 30000
2013-03-29 09:33:44,413 - INFO  [main:JMXEnv@105] - expect:0x13db3c76daf0000
2013-03-29 09:33:44,414 - INFO  [main:JMXEnv@108] - found:0x13db3c76daf0000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3c76daf0000
2013-03-29 09:33:44,519 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@4e8aeb09
2013-03-29 09:33:44,520 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:33:44,521 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:33:44,521 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:33:44,521 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5061
2013-03-29 09:33:44,522 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5061
2013-03-29 09:33:44,543 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c76daf0001 with negotiated timeout 10000 for client /127.0.0.1:5061
2013-03-29 09:33:44,543 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c76daf0001, negotiated timeout = 10000
2013-03-29 09:33:44,547 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:33:44,712 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:33:44,728 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:33:44,728 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:33:44,732 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:33:44,733 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:33:44,737 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150012287799083351494438test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:33:44,743 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150012287799083351494438test\current\33562f.txn
2013-03-29 09:33:44,819 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@4ba6b85d
2013-03-29 09:33:44,822 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:33:44,823 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:33:44,826 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5066
2013-03-29 09:33:44,826 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:33:44,827 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5066
2013-03-29 09:33:44,884 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c76daf0002 with negotiated timeout 10000 for client /127.0.0.1:5066
2013-03-29 09:33:44,885 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c76daf0002, negotiated timeout = 10000
2013-03-29 09:33:44,887 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:33:45,007 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:33:45,009 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:33:45,010 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:33:45,010 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:33:45,011 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:33:45,011 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150023125944120829387118test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:33:45,013 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150023125944120829387118test\current\33573d.txn
2013-03-29 09:33:45,126 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@1936982
2013-03-29 09:33:45,131 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:33:45,132 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:33:45,134 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:33:45,154 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5071
2013-03-29 09:33:45,154 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5071
2013-03-29 09:33:45,208 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c76daf0003 with negotiated timeout 10000 for client /127.0.0.1:5071
2013-03-29 09:33:45,208 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c76daf0003, negotiated timeout = 10000
2013-03-29 09:33:45,209 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:33:45,322 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:33:45,324 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:33:45,325 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:33:45,325 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:33:45,326 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:33:45,326 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150037683029959066748443test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:33:45,328 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150037683029959066748443test\current\335878.txn
2013-03-29 09:33:45,409 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@4782fe29
2013-03-29 09:33:45,410 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:33:45,411 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:33:45,411 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:33:45,411 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5076
2013-03-29 09:33:45,412 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5076
2013-03-29 09:33:45,420 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c76daf0004 with negotiated timeout 10000 for client /127.0.0.1:5076
2013-03-29 09:33:45,420 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c76daf0004, negotiated timeout = 10000
2013-03-29 09:33:45,477 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@4d53ae47
2013-03-29 09:33:45,479 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:33:45,479 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:33:45,479 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:33:45,479 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5079
2013-03-29 09:33:45,480 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5079
2013-03-29 09:33:45,489 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c76daf0005 with negotiated timeout 6000 for client /127.0.0.1:5079
2013-03-29 09:33:45,489 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c76daf0005, negotiated timeout = 6000
2013-03-29 09:33:45,563 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c76daf0005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 09:33:45,572 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c76daf0005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 09:33:45,579 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c76daf0005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 09:33:45,587 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c76daf0005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 09:33:45,651 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c76daf0005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 09:33:45,685 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 09:33:45,745 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:33:45,917 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:33:45,922 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 09:33:46,000 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 09:33:46,002 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c76daf0005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 09:33:46,019 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c76daf0005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 09:33:46,065 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 09:33:46,074 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 09:33:46,114 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c76daf0005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 09:33:46,146 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 09:33:46,158 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 09:33:46,172 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 09:33:46,173 - INFO  [New I/O client worker #2-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 09:33:46,175 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 09:33:46,344 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 09:33:46,368 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 09:33:47,259 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5118 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:33:47,262 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5117 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:33:47,312 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 09:33:47,312 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 09:33:47,313 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5118 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 09:33:47,313 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1018] - On channel disconnected
2013-03-29 09:33:47,316 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 09:33:47,317 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - cc.waitingConsumers.size() = 1
2013-03-29 09:33:47,318 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x624733f0, /127.0.0.1:5117 => /127.0.0.1:60000]
2013-03-29 09:33:47,318 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1398] - Delivering: true
2013-03-29 09:33:47,320 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1443] - the size of retry MessageQueue :0
2013-03-29 09:33:47,488 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@884] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:33:47,489 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1241] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:33:47,500 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@884] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:33:47,501 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1241] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:33:47,503 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@884] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:33:47,503 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1241] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:33:47,504 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@884] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:33:47,504 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:33:47,504 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 1
2013-03-29 09:33:47,504 - INFO  [New I/O server worker #1-5:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 2
2013-03-29 09:33:47,505 - ERROR [DeliveryManagerThread:TerminateJVMExceptionHandler@28] - Uncaught exception in thread DeliveryManagerThread
java.lang.IllegalMonitorStateException
	at java.util.concurrent.locks.ReentrantLock$Sync.tryRelease(ReentrantLock.java:155)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.release(AbstractQueuedSynchronizer.java:1260)
	at java.util.concurrent.locks.ReentrantLock.unlock(ReentrantLock.java:460)
	at org.apache.hedwig.server.delivery.FIFODeliveryManager$AsyncSendingQueueMessage.performRequest(FIFODeliveryManager.java:855)
	at org.apache.hedwig.server.delivery.FIFODeliveryManager.run(FIFODeliveryManager.java:355)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 09:33:47,508 - ERROR [Thread-3:FileUtils$DirDeleterThred@76] - Could not delete C:\Users\Zac\AppData\Local\Temp\bookie150012287799083351494438test\current\0\3\3.idx
2013-03-29 09:33:47,508 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150012287799083351494438test\current\0\3
2013-03-29 09:33:47,509 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150012287799083351494438test\current\0
2013-03-29 09:33:47,509 - ERROR [Thread-3:FileUtils$DirDeleterThred@76] - Could not delete C:\Users\Zac\AppData\Local\Temp\bookie150012287799083351494438test\current\0.log
2013-03-29 09:33:47,509 - ERROR [Thread-3:FileUtils$DirDeleterThred@76] - Could not delete C:\Users\Zac\AppData\Local\Temp\bookie150012287799083351494438test\current\33562f.txn
2013-03-29 09:33:47,511 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150012287799083351494438test\current
2013-03-29 09:33:47,511 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150012287799083351494438test
2013-03-29 09:33:47,512 - ERROR [Thread-3:FileUtils$DirDeleterThred@76] - Could not delete C:\Users\Zac\AppData\Local\Temp\bookie150023125944120829387118test\current\0\3\3.idx
2013-03-29 09:33:47,513 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150023125944120829387118test\current\0\3
2013-03-29 09:33:47,513 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150023125944120829387118test\current\0
2013-03-29 09:33:47,513 - ERROR [Thread-3:FileUtils$DirDeleterThred@76] - Could not delete C:\Users\Zac\AppData\Local\Temp\bookie150023125944120829387118test\current\0.log
2013-03-29 09:33:47,514 - ERROR [Thread-3:FileUtils$DirDeleterThred@76] - Could not delete C:\Users\Zac\AppData\Local\Temp\bookie150023125944120829387118test\current\33573d.txn
2013-03-29 09:33:47,515 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150023125944120829387118test\current
2013-03-29 09:33:47,516 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150023125944120829387118test
2013-03-29 09:33:47,518 - ERROR [Thread-3:FileUtils$DirDeleterThred@76] - Could not delete C:\Users\Zac\AppData\Local\Temp\bookie150037683029959066748443test\current\0\3\3.idx
2013-03-29 09:33:47,518 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150037683029959066748443test\current\0\3
2013-03-29 09:33:47,519 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150037683029959066748443test\current\0
2013-03-29 09:33:47,519 - ERROR [Thread-3:FileUtils$DirDeleterThred@76] - Could not delete C:\Users\Zac\AppData\Local\Temp\bookie150037683029959066748443test\current\0.log
2013-03-29 09:33:47,520 - ERROR [Thread-3:FileUtils$DirDeleterThred@76] - Could not delete C:\Users\Zac\AppData\Local\Temp\bookie150037683029959066748443test\current\335878.txn
2013-03-29 09:33:47,521 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150037683029959066748443test\current
2013-03-29 09:33:47,521 - ERROR [Thread-3:FileUtils$DirDeleterThred@91] - Could not delete directory: C:\Users\Zac\AppData\Local\Temp\bookie150037683029959066748443test
2013-03-29 09:34:37,167 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 09:34:37,188 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 09:34:37,383 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 09:34:37,392 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:34:37,393 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 09:34:37,393 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 09:34:37,394 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 09:34:37,394 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:34:37,395 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:34:37,396 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:34:37,396 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:34:37,397 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 09:34:37,397 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 09:34:37,398 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 09:34:37,398 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 09:34:37,399 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 09:34:37,399 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 09:34:37,400 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:34:37,416 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test6199220369692624381.junit.dir\version-2 snapdir E:\test\test6199220369692624381.junit.dir\version-2
2013-03-29 09:34:37,429 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 09:34:37,434 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test6199220369692624381.junit.dir\version-2\snapshot.0
2013-03-29 09:34:37,456 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 09:34:37,457 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5145
2013-03-29 09:34:37,461 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:5145
2013-03-29 09:34:37,463 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 09:34:37,463 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5145 (no session established for client)
2013-03-29 09:34:37,464 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 09:34:37,468 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 09:34:37,469 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 09:34:37,469 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 09:34:37,470 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 09:34:37,470 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 09:34:37,477 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:34:37,478 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 09:34:37,478 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 09:34:37,479 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 09:34:37,479 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:34:37,480 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:34:37,481 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:34:37,482 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:34:37,482 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 09:34:37,482 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 09:34:37,482 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 09:34:37,483 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 09:34:37,483 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 09:34:37,483 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 09:34:37,484 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:34:37,485 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@3e374059
2013-03-29 09:34:37,498 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:34:37,502 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:34:37,503 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5148
2013-03-29 09:34:37,503 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:34:37,506 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5148
2013-03-29 09:34:37,510 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 09:34:37,581 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c83d810000 with negotiated timeout 30000 for client /127.0.0.1:5148
2013-03-29 09:34:37,581 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c83d810000, negotiated timeout = 30000
2013-03-29 09:34:37,585 - INFO  [main:JMXEnv@105] - expect:0x13db3c83d810000
2013-03-29 09:34:37,586 - INFO  [main:JMXEnv@108] - found:0x13db3c83d810000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3c83d810000
2013-03-29 09:34:37,691 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@24cc428
2013-03-29 09:34:37,692 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:34:37,693 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:34:37,693 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:34:37,693 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5151
2013-03-29 09:34:37,694 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5151
2013-03-29 09:34:37,699 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c83d810001 with negotiated timeout 10000 for client /127.0.0.1:5151
2013-03-29 09:34:37,699 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c83d810001, negotiated timeout = 10000
2013-03-29 09:34:37,702 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:34:37,891 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:34:37,910 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:34:37,911 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:34:37,916 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:34:37,917 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:34:37,921 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150015005934682571994607test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:34:37,929 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150015005934682571994607test\current\3425ef.txn
2013-03-29 09:34:37,987 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@2e920878
2013-03-29 09:34:37,989 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:34:37,989 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:34:37,998 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:34:37,998 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5156
2013-03-29 09:34:37,999 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5156
2013-03-29 09:34:38,060 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c83d810002 with negotiated timeout 10000 for client /127.0.0.1:5156
2013-03-29 09:34:38,060 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c83d810002, negotiated timeout = 10000
2013-03-29 09:34:38,061 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:34:38,120 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:34:38,122 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:34:38,123 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:34:38,123 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:34:38,124 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:34:38,124 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150026196792294827669981test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:34:38,127 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150026196792294827669981test\current\3426b7.txn
2013-03-29 09:34:38,230 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@74f3d69c
2013-03-29 09:34:38,231 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:34:38,231 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:34:38,232 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:34:38,232 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5161
2013-03-29 09:34:38,233 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5161
2013-03-29 09:34:38,295 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c83d810003 with negotiated timeout 10000 for client /127.0.0.1:5161
2013-03-29 09:34:38,295 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c83d810003, negotiated timeout = 10000
2013-03-29 09:34:38,296 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:34:38,308 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:34:38,309 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:34:38,310 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:34:38,310 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:34:38,311 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:34:38,311 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150035163885574036518531test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:34:38,315 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150035163885574036518531test\current\342772.txn
2013-03-29 09:34:38,350 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@6624d938
2013-03-29 09:34:38,351 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:34:38,352 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:34:38,353 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:34:38,353 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5166
2013-03-29 09:34:38,353 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5166
2013-03-29 09:34:38,407 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c83d810004 with negotiated timeout 10000 for client /127.0.0.1:5166
2013-03-29 09:34:38,407 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c83d810004, negotiated timeout = 10000
2013-03-29 09:34:38,456 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@343526f3
2013-03-29 09:34:38,457 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:34:38,457 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:34:38,458 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:34:38,458 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5169
2013-03-29 09:34:38,458 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5169
2013-03-29 09:34:38,465 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c83d810005 with negotiated timeout 6000 for client /127.0.0.1:5169
2013-03-29 09:34:38,465 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c83d810005, negotiated timeout = 6000
2013-03-29 09:34:38,548 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c83d810005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 09:34:38,559 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c83d810005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 09:34:38,567 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c83d810005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 09:34:38,632 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c83d810005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 09:34:38,700 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c83d810005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 09:34:38,726 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 09:34:38,793 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:34:38,986 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:34:38,991 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 09:34:39,067 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 09:34:39,069 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c83d810005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 09:34:39,116 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c83d810005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 09:34:39,243 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 09:34:39,252 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 09:34:39,335 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c83d810005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 09:34:39,359 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 09:34:39,371 - INFO  [pool-17-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 09:34:39,385 - INFO  [pool-17-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 09:34:39,387 - INFO  [New I/O client worker #2-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 09:34:39,396 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 09:34:39,505 - INFO  [pool-17-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 09:34:39,555 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 09:34:40,372 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5207 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:34:40,377 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5206 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:34:40,429 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 09:34:40,429 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 09:34:40,430 - INFO  [New I/O server worker #1-5:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5206 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 09:34:40,431 - INFO  [New I/O server worker #1-5:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 09:34:40,432 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 09:34:40,432 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 09:34:40,433 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 1
2013-03-29 09:34:40,433 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x1509f38f, /127.0.0.1:5207 => /127.0.0.1:60000]
2013-03-29 09:34:40,433 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - Delivering: true
2013-03-29 09:34:40,434 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 09:34:40,434 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 68
2013-03-29 09:34:40,435 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 68
2013-03-29 09:34:40,458 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:34:40,458 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:34:40,459 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:34:40,459 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:34:40,461 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:34:40,461 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:34:40,461 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 1
2013-03-29 09:34:40,462 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:34:40,462 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 2
2013-03-29 09:34:40,462 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:34:40,462 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 3
2013-03-29 09:34:40,462 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:34:40,463 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:34:40,463 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:34:40,463 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:34:40,463 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:34:40,463 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:34:40,464 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:34:40,464 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :3
2013-03-29 09:34:40,464 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 192
2013-03-29 09:34:40,464 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 193
2013-03-29 09:34:40,465 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 194
2013-03-29 09:34:40,465 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:34:40,465 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:34:40,465 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:34:40,465 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:34:40,466 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:34:40,485 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 184
2013-03-29 09:34:40,485 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 185
2013-03-29 09:34:40,602 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5207 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 09:34:40,603 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 09:34:40,603 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 09:34:40,603 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 0
2013-03-29 09:34:40,604 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1401] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 09:34:40,604 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1403] - Last consumed seq: 502
2013-03-29 09:34:40,605 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:34:40,605 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 4
2013-03-29 09:34:55,273 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 09:34:55,340 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15002
2013-03-29 09:34:55,344 - INFO  [New I/O client worker #2-1:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15001
2013-03-29 09:34:55,356 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15003
2013-03-29 09:34:55,358 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c83d810005
2013-03-29 09:34:55,365 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5169 which had sessionid 0x13db3c83d810005
2013-03-29 09:34:55,366 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c83d810005 closed
2013-03-29 09:34:55,369 - INFO  [New I/O client worker #4-1:HChannelHandler@244] - Channel [id: 0x1084027e, /0:0:0:0:0:0:0:0:5193 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 09:34:55,370 - INFO  [New I/O client worker #4-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x1084027e, /0:0:0:0:0:0:0:0:5193 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 09:34:55,370 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x1b1249bd, /127.0.0.1:5174 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 09:34:55,371 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x1b1249bd, /127.0.0.1:5174 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 09:34:55,377 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:34:55,387 - WARN  [NIOServerFactory-15001:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 09:34:55,388 - INFO  [NIOServerFactory-15001:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:34:55,389 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c83d810001
2013-03-29 09:34:55,406 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c83d810001 closed
2013-03-29 09:34:55,406 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:34:55,406 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5151 which had sessionid 0x13db3c83d810001
2013-03-29 09:34:55,406 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:34:55,407 - WARN  [BookieJournal-15001:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:34:55,422 - WARN  [NIOServerFactory-15002:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 09:34:55,423 - INFO  [NIOServerFactory-15002:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:34:55,423 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c83d810002
2013-03-29 09:34:55,439 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5156 which had sessionid 0x13db3c83d810002
2013-03-29 09:34:55,439 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c83d810002 closed
2013-03-29 09:34:55,440 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:34:55,440 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:34:55,441 - WARN  [BookieJournal-15002:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:34:55,473 - WARN  [NIOServerFactory-15003:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 09:34:55,474 - INFO  [NIOServerFactory-15003:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:34:55,474 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c83d810003
2013-03-29 09:34:55,497 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5161 which had sessionid 0x13db3c83d810003
2013-03-29 09:34:55,497 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:34:55,497 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c83d810003 closed
2013-03-29 09:34:55,498 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:34:55,498 - WARN  [BookieJournal-15003:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:34:55,520 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c83d810004
2013-03-29 09:34:55,539 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c83d810004 closed
2013-03-29 09:34:55,540 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 09:34:55,539 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:34:55,539 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5166 which had sessionid 0x13db3c83d810004
2013-03-29 09:34:55,541 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c83d810000
2013-03-29 09:34:55,547 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c83d810000 closed
2013-03-29 09:34:55,548 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 09:34:55,547 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@349] - caught end of stream exception
EndOfStreamException: Unable to read additional data from client sessionid 0x13db3c83d810000, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:220)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:224)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 09:34:55,548 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5148 which had sessionid 0x13db3c83d810000
2013-03-29 09:34:55,548 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:34:55,560 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@234] - Ignoring unexpected runtime exception
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:203)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 09:34:55,560 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 09:34:55,561 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 09:34:55,561 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 09:34:55,561 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 09:34:55,583 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 09:34:55,585 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 09:34:55,585 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 09:34:55,586 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 09:34:55,587 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 09:34:56,593 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 09:34:56,605 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
2013-03-29 09:36:14,585 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 09:36:14,606 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 09:36:14,779 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 09:36:14,789 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:36:14,790 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 09:36:14,790 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 09:36:14,791 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 09:36:14,792 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:36:14,793 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:36:14,794 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:36:14,794 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:36:14,795 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 09:36:14,795 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 09:36:14,795 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 09:36:14,796 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 09:36:14,797 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 09:36:14,797 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 09:36:14,798 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:36:14,814 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test4290780597622303738.junit.dir\version-2 snapdir E:\test\test4290780597622303738.junit.dir\version-2
2013-03-29 09:36:14,827 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 09:36:14,832 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test4290780597622303738.junit.dir\version-2\snapshot.0
2013-03-29 09:36:14,853 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 09:36:14,854 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5245
2013-03-29 09:36:14,858 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:5245
2013-03-29 09:36:14,860 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 09:36:14,861 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5245 (no session established for client)
2013-03-29 09:36:14,861 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 09:36:14,865 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 09:36:14,866 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 09:36:14,866 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 09:36:14,866 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 09:36:14,867 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 09:36:14,872 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:36:14,872 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 09:36:14,872 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 09:36:14,873 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 09:36:14,873 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:36:14,873 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:36:14,874 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:36:14,874 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:36:14,875 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 09:36:14,875 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 09:36:14,875 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 09:36:14,875 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 09:36:14,876 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 09:36:14,876 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 09:36:14,876 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:36:14,878 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@792cc6d9
2013-03-29 09:36:14,891 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:14,894 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:14,895 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5248
2013-03-29 09:36:14,895 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:14,898 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5248
2013-03-29 09:36:14,901 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 09:36:14,972 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c9b9f60000 with negotiated timeout 30000 for client /127.0.0.1:5248
2013-03-29 09:36:14,972 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c9b9f60000, negotiated timeout = 30000
2013-03-29 09:36:14,977 - INFO  [main:JMXEnv@105] - expect:0x13db3c9b9f60000
2013-03-29 09:36:14,978 - INFO  [main:JMXEnv@108] - found:0x13db3c9b9f60000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3c9b9f60000
2013-03-29 09:36:15,082 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@4e8aeb09
2013-03-29 09:36:15,083 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:15,084 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:15,084 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:15,084 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5251
2013-03-29 09:36:15,085 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5251
2013-03-29 09:36:15,095 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c9b9f60001 with negotiated timeout 10000 for client /127.0.0.1:5251
2013-03-29 09:36:15,095 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c9b9f60001, negotiated timeout = 10000
2013-03-29 09:36:15,098 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:36:15,270 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:36:15,283 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:36:15,283 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:36:15,287 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:36:15,288 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:36:15,291 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150012272898171284896024test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:36:15,297 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150012272898171284896024test\current\35a246.txn
2013-03-29 09:36:15,366 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@397f2a20
2013-03-29 09:36:15,369 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:15,370 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:15,384 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5256
2013-03-29 09:36:15,384 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:15,385 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5256
2013-03-29 09:36:15,431 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c9b9f60002 with negotiated timeout 10000 for client /127.0.0.1:5256
2013-03-29 09:36:15,431 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c9b9f60002, negotiated timeout = 10000
2013-03-29 09:36:15,432 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:36:15,501 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:36:15,503 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:36:15,503 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:36:15,504 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:36:15,504 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:36:15,505 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150026459043458476471097test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:36:15,506 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150026459043458476471097test\current\35a319.txn
2013-03-29 09:36:15,566 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@18aabe9c
2013-03-29 09:36:15,568 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:15,568 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:15,569 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:15,569 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5261
2013-03-29 09:36:15,570 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5261
2013-03-29 09:36:15,636 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c9b9f60003 with negotiated timeout 10000 for client /127.0.0.1:5261
2013-03-29 09:36:15,637 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c9b9f60003, negotiated timeout = 10000
2013-03-29 09:36:15,638 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:36:15,654 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:36:15,655 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:36:15,655 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:36:15,656 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:36:15,657 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:36:15,661 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150036431759088939378537test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:36:15,664 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150036431759088939378537test\current\35a3b6.txn
2013-03-29 09:36:15,735 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@21546f3
2013-03-29 09:36:15,737 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:15,737 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:15,738 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:15,738 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5266
2013-03-29 09:36:15,738 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5266
2013-03-29 09:36:15,765 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c9b9f60004 with negotiated timeout 10000 for client /127.0.0.1:5266
2013-03-29 09:36:15,765 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c9b9f60004, negotiated timeout = 10000
2013-03-29 09:36:15,819 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@7e33d502
2013-03-29 09:36:15,820 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:15,821 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:15,821 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:15,821 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5269
2013-03-29 09:36:15,822 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5269
2013-03-29 09:36:15,832 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3c9b9f60005 with negotiated timeout 6000 for client /127.0.0.1:5269
2013-03-29 09:36:15,832 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3c9b9f60005, negotiated timeout = 6000
2013-03-29 09:36:15,907 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c9b9f60005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 09:36:15,921 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c9b9f60005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 09:36:15,932 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c9b9f60005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 09:36:15,945 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c9b9f60005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 09:36:16,028 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c9b9f60005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 09:36:16,068 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 09:36:16,132 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:36:16,319 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:36:16,324 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 09:36:16,403 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 09:36:16,404 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c9b9f60005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 09:36:16,427 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c9b9f60005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 09:36:16,489 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 09:36:16,508 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 09:36:16,564 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3c9b9f60005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 09:36:16,645 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 09:36:16,657 - INFO  [pool-14-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 09:36:16,670 - INFO  [pool-14-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 09:36:16,671 - INFO  [New I/O client worker #2-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 09:36:16,673 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 09:36:16,775 - INFO  [pool-17-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 09:36:16,816 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 09:36:17,731 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5308 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:36:17,734 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5307 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:36:17,791 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 09:36:17,791 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 09:36:17,794 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5308 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 09:36:17,795 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 09:36:17,795 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 09:36:17,796 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 09:36:17,796 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 1
2013-03-29 09:36:17,797 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x3394ef9f, /127.0.0.1:5307 => /127.0.0.1:60000]
2013-03-29 09:36:17,797 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - Delivering: true
2013-03-29 09:36:17,798 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:36:17,798 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:36:17,798 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:36:17,798 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:36:17,799 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:36:17,799 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:36:17,799 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :8
2013-03-29 09:36:17,799 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 73
2013-03-29 09:36:17,800 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 75
2013-03-29 09:36:17,800 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 77
2013-03-29 09:36:17,800 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 79
2013-03-29 09:36:17,801 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 81
2013-03-29 09:36:17,801 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 83
2013-03-29 09:36:17,801 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 85
2013-03-29 09:36:17,801 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 87
2013-03-29 09:36:17,801 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:36:17,802 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:36:17,802 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:36:17,802 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:36:17,802 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:36:17,802 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:36:17,936 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 79
2013-03-29 09:36:17,937 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 81
2013-03-29 09:36:17,938 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 87
2013-03-29 09:36:17,983 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 73
2013-03-29 09:36:17,983 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 75
2013-03-29 09:36:17,984 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 77
2013-03-29 09:36:18,139 - INFO  [New I/O server worker #1-5:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5307 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 09:36:18,139 - INFO  [New I/O server worker #1-5:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 09:36:18,140 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 0
2013-03-29 09:36:18,140 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1401] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 09:36:18,141 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1403] - Last consumed seq: 493
2013-03-29 09:36:18,142 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:36:18,142 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 1
2013-03-29 09:36:32,619 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 09:36:32,694 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15002
2013-03-29 09:36:32,697 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15001
2013-03-29 09:36:32,700 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15003
2013-03-29 09:36:32,703 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c9b9f60005
2013-03-29 09:36:32,714 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5269 which had sessionid 0x13db3c9b9f60005
2013-03-29 09:36:32,715 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c9b9f60005 closed
2013-03-29 09:36:32,715 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:36:32,718 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x4f4127c0, /127.0.0.1:5275 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 09:36:32,718 - INFO  [New I/O client worker #4-1:HChannelHandler@244] - Channel [id: 0x733e994c, /0:0:0:0:0:0:0:0:5294 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 09:36:32,719 - INFO  [New I/O client worker #4-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x733e994c, /0:0:0:0:0:0:0:0:5294 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 09:36:32,718 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x4f4127c0, /127.0.0.1:5275 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 09:36:32,731 - WARN  [NIOServerFactory-15001:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.ClosedChannelException
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:211)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:146)
2013-03-29 09:36:32,731 - INFO  [NIOServerFactory-15001:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:36:32,732 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c9b9f60001
2013-03-29 09:36:32,743 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c9b9f60001 closed
2013-03-29 09:36:32,743 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:36:32,743 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5251 which had sessionid 0x13db3c9b9f60001
2013-03-29 09:36:32,744 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:36:32,744 - WARN  [BookieJournal-15001:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:36:32,760 - WARN  [NIOServerFactory-15002:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 09:36:32,760 - INFO  [NIOServerFactory-15002:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:36:32,761 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c9b9f60002
2013-03-29 09:36:32,780 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5256 which had sessionid 0x13db3c9b9f60002
2013-03-29 09:36:32,780 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c9b9f60002 closed
2013-03-29 09:36:32,781 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:36:32,781 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:36:32,782 - WARN  [BookieJournal-15002:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:36:32,828 - INFO  [NIOServerFactory-15003:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:36:32,829 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c9b9f60003
2013-03-29 09:36:32,852 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5261 which had sessionid 0x13db3c9b9f60003
2013-03-29 09:36:32,854 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c9b9f60003 closed
2013-03-29 09:36:32,854 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:36:32,854 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:36:32,855 - WARN  [BookieJournal-15003:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:36:32,887 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c9b9f60004
2013-03-29 09:36:32,909 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5266 which had sessionid 0x13db3c9b9f60004
2013-03-29 09:36:32,910 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:36:32,909 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c9b9f60004 closed
2013-03-29 09:36:32,910 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 09:36:32,911 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3c9b9f60000
2013-03-29 09:36:32,926 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5248 which had sessionid 0x13db3c9b9f60000
2013-03-29 09:36:32,927 - INFO  [main:ZooKeeper@679] - Session: 0x13db3c9b9f60000 closed
2013-03-29 09:36:32,927 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 09:36:32,928 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:36:32,929 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 09:36:32,929 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 09:36:32,929 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 09:36:32,930 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 09:36:32,930 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 09:36:32,930 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 09:36:32,931 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 09:36:32,931 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 09:36:32,932 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 09:36:33,000 - INFO  [SessionTracker:SessionTrackerImpl@162] - SessionTrackerImpl exited loop!
2013-03-29 09:36:33,932 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 09:36:33,939 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
2013-03-29 09:36:52,770 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 09:36:52,793 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 09:36:52,971 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 09:36:52,982 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:36:52,982 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 09:36:52,986 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 09:36:52,986 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 09:36:52,987 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:36:52,988 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:36:52,989 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:36:52,989 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:36:52,989 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 09:36:52,990 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 09:36:52,990 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 09:36:52,991 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 09:36:52,991 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 09:36:52,991 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 09:36:52,992 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:36:53,008 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test7148377033986855448.junit.dir\version-2 snapdir E:\test\test7148377033986855448.junit.dir\version-2
2013-03-29 09:36:53,020 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 09:36:53,026 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test7148377033986855448.junit.dir\version-2\snapshot.0
2013-03-29 09:36:53,047 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 09:36:53,048 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5332
2013-03-29 09:36:53,052 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:5332
2013-03-29 09:36:53,054 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 09:36:53,055 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5332 (no session established for client)
2013-03-29 09:36:53,055 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 09:36:53,059 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 09:36:53,060 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 09:36:53,060 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 09:36:53,060 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 09:36:53,061 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 09:36:53,065 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:36:53,066 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 09:36:53,066 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 09:36:53,067 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 09:36:53,067 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:36:53,067 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:36:53,068 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:36:53,068 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:36:53,068 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 09:36:53,069 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 09:36:53,069 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 09:36:53,069 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 09:36:53,070 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 09:36:53,070 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 09:36:53,070 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:36:53,072 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@792cc6d9
2013-03-29 09:36:53,087 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:53,090 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:53,091 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5335
2013-03-29 09:36:53,091 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:53,094 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5335
2013-03-29 09:36:53,098 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 09:36:53,156 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ca4f280000 with negotiated timeout 30000 for client /127.0.0.1:5335
2013-03-29 09:36:53,156 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ca4f280000, negotiated timeout = 30000
2013-03-29 09:36:53,160 - INFO  [main:JMXEnv@105] - expect:0x13db3ca4f280000
2013-03-29 09:36:53,161 - INFO  [main:JMXEnv@108] - found:0x13db3ca4f280000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3ca4f280000
2013-03-29 09:36:53,271 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@f98c4b6
2013-03-29 09:36:53,276 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:53,277 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:53,277 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:53,277 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5338
2013-03-29 09:36:53,278 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5338
2013-03-29 09:36:53,304 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ca4f280001 with negotiated timeout 10000 for client /127.0.0.1:5338
2013-03-29 09:36:53,304 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ca4f280001, negotiated timeout = 10000
2013-03-29 09:36:53,308 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:36:53,488 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:36:53,502 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:36:53,502 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:36:53,507 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:36:53,507 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:36:53,511 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie15001200393262640022846test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:36:53,518 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie15001200393262640022846test\current\363793.txn
2013-03-29 09:36:53,612 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@7ce1ef11
2013-03-29 09:36:53,614 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:53,615 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:53,615 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:53,615 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5344
2013-03-29 09:36:53,618 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5344
2013-03-29 09:36:53,682 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ca4f280002 with negotiated timeout 10000 for client /127.0.0.1:5344
2013-03-29 09:36:53,682 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ca4f280002, negotiated timeout = 10000
2013-03-29 09:36:53,683 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:36:53,751 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:36:53,754 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:36:53,755 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:36:53,757 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:36:53,757 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:36:53,759 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150024855439415482545850test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:36:53,762 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150024855439415482545850test\current\363888.txn
2013-03-29 09:36:53,835 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@6ee38785
2013-03-29 09:36:53,838 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:53,839 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:53,840 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:53,840 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5349
2013-03-29 09:36:53,841 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5349
2013-03-29 09:36:53,879 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ca4f280003 with negotiated timeout 10000 for client /127.0.0.1:5349
2013-03-29 09:36:53,879 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ca4f280003, negotiated timeout = 10000
2013-03-29 09:36:53,880 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:36:53,905 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:36:53,907 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:36:53,907 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:36:53,908 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:36:53,908 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:36:53,909 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150032487578214412235389test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:36:53,923 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150032487578214412235389test\current\363929.txn
2013-03-29 09:36:54,007 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5f36ba9b
2013-03-29 09:36:54,009 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:54,009 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:54,010 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:54,065 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5354
2013-03-29 09:36:54,065 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5354
2013-03-29 09:36:54,095 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ca4f280004 with negotiated timeout 10000 for client /127.0.0.1:5354
2013-03-29 09:36:54,095 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ca4f280004, negotiated timeout = 10000
2013-03-29 09:36:54,154 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@40f69ae7
2013-03-29 09:36:54,156 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:36:54,156 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:36:54,157 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:36:54,157 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5357
2013-03-29 09:36:54,157 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5357
2013-03-29 09:36:54,170 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ca4f280005 with negotiated timeout 6000 for client /127.0.0.1:5357
2013-03-29 09:36:54,170 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ca4f280005, negotiated timeout = 6000
2013-03-29 09:36:54,246 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ca4f280005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 09:36:54,263 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ca4f280005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 09:36:54,278 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ca4f280005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 09:36:54,295 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ca4f280005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 09:36:54,406 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ca4f280005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 09:36:54,457 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 09:36:54,540 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:36:54,723 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:36:54,728 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 09:36:54,802 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 09:36:54,804 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ca4f280005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 09:36:54,819 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ca4f280005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 09:36:54,904 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 09:36:54,913 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 09:36:54,973 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ca4f280005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 09:36:55,021 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 09:36:55,036 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 09:36:55,054 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 09:36:55,062 - INFO  [New I/O client worker #2-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 09:36:55,065 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 09:36:55,230 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 09:36:55,319 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 09:36:56,104 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5394 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:36:56,107 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5395 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:36:56,157 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 09:36:56,157 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 09:36:56,159 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 09:36:56,159 - INFO  [New I/O server worker #1-5:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5395 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 09:36:56,160 - INFO  [New I/O server worker #1-5:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 09:36:56,161 - INFO  [New I/O server worker #1-5:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 09:36:56,161 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 1
2013-03-29 09:36:56,162 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x0a15ace5, /127.0.0.1:5394 => /127.0.0.1:60000]
2013-03-29 09:36:56,162 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - Delivering: true
2013-03-29 09:36:56,163 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 09:36:56,163 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 118
2013-03-29 09:36:56,163 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 120
2013-03-29 09:36:56,164 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 120
2013-03-29 09:36:56,314 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5394 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 09:36:56,314 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 09:36:56,317 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 0
2013-03-29 09:36:56,317 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1401] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 09:36:56,318 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1403] - Last consumed seq: 505
2013-03-29 09:37:10,971 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 09:37:11,020 - INFO  [New I/O client worker #2-3:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15002
2013-03-29 09:37:11,022 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15001
2013-03-29 09:37:11,030 - INFO  [New I/O client worker #2-1:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15003
2013-03-29 09:37:11,033 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ca4f280005
2013-03-29 09:37:11,052 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5357 which had sessionid 0x13db3ca4f280005
2013-03-29 09:37:11,053 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ca4f280005 closed
2013-03-29 09:37:11,056 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:37:11,057 - INFO  [New I/O client worker #4-1:HChannelHandler@244] - Channel [id: 0x12c24609, /127.0.0.1:5381 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 09:37:11,058 - INFO  [New I/O client worker #4-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x12c24609, /127.0.0.1:5381 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 09:37:11,064 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x4f4127c0, /127.0.0.1:5362 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 09:37:11,064 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x4f4127c0, /127.0.0.1:5362 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 09:37:11,071 - WARN  [NIOServerFactory-15001:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.ClosedChannelException
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:211)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:146)
2013-03-29 09:37:11,072 - INFO  [NIOServerFactory-15001:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:37:11,073 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ca4f280001
2013-03-29 09:37:11,085 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ca4f280001 closed
2013-03-29 09:37:11,085 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:37:11,085 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@349] - caught end of stream exception
EndOfStreamException: Unable to read additional data from client sessionid 0x13db3ca4f280001, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:220)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:224)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 09:37:11,085 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:37:11,086 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5338 which had sessionid 0x13db3ca4f280001
2013-03-29 09:37:11,086 - WARN  [BookieJournal-15001:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:37:11,114 - WARN  [NIOServerFactory-15002:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 09:37:11,115 - INFO  [NIOServerFactory-15002:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:37:11,115 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ca4f280002
2013-03-29 09:37:11,143 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ca4f280002 closed
2013-03-29 09:37:11,144 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5344 which had sessionid 0x13db3ca4f280002
2013-03-29 09:37:11,143 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:37:11,144 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:37:11,145 - WARN  [BookieJournal-15002:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:37:11,164 - INFO  [NIOServerFactory-15003:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:37:11,165 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ca4f280003
2013-03-29 09:37:11,194 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ca4f280003 closed
2013-03-29 09:37:11,194 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5349 which had sessionid 0x13db3ca4f280003
2013-03-29 09:37:11,194 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:37:11,194 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:37:11,196 - WARN  [BookieJournal-15003:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:37:11,229 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ca4f280004
2013-03-29 09:37:11,252 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ca4f280004 closed
2013-03-29 09:37:11,252 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5354 which had sessionid 0x13db3ca4f280004
2013-03-29 09:37:11,252 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:37:11,252 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 09:37:11,254 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ca4f280000
2013-03-29 09:37:11,268 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ca4f280000 closed
2013-03-29 09:37:11,268 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5335 which had sessionid 0x13db3ca4f280000
2013-03-29 09:37:11,268 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:37:11,269 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 09:37:11,270 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 09:37:11,271 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 09:37:11,271 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 09:37:11,272 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 09:37:11,272 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 09:37:11,272 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 09:37:11,272 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 09:37:11,273 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 09:37:11,274 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 09:37:12,000 - INFO  [SessionTracker:SessionTrackerImpl@162] - SessionTrackerImpl exited loop!
2013-03-29 09:37:12,274 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 09:37:12,279 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
2013-03-29 09:43:24,958 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 09:43:24,978 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 09:43:25,175 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 09:43:25,191 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:43:25,192 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 09:43:25,195 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 09:43:25,195 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 09:43:25,195 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:43:25,196 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:43:25,197 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:43:25,197 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:43:25,197 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 09:43:25,198 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 09:43:25,198 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 09:43:25,199 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 09:43:25,199 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 09:43:25,199 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 09:43:25,200 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:43:25,224 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test1740937851485555352.junit.dir\version-2 snapdir E:\test\test1740937851485555352.junit.dir\version-2
2013-03-29 09:43:25,236 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 09:43:25,242 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test1740937851485555352.junit.dir\version-2\snapshot.0
2013-03-29 09:43:25,268 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 09:43:25,269 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5512
2013-03-29 09:43:25,275 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:5512
2013-03-29 09:43:25,278 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 09:43:25,279 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5512 (no session established for client)
2013-03-29 09:43:25,280 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 09:43:25,285 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 09:43:25,286 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 09:43:25,286 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 09:43:25,287 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 09:43:25,287 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 09:43:25,294 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 09:43:25,295 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 09:43:25,295 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 09:43:25,296 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 09:43:25,296 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 09:43:25,297 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 09:43:25,297 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 09:43:25,297 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 09:43:25,298 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 09:43:25,298 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 09:43:25,298 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 09:43:25,299 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 09:43:25,299 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 09:43:25,299 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 09:43:25,300 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 09:43:25,301 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@7ef9f3b2
2013-03-29 09:43:25,313 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:43:25,317 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:43:25,318 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5515
2013-03-29 09:43:25,318 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:43:25,320 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5515
2013-03-29 09:43:25,322 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 09:43:25,369 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3d04b400000 with negotiated timeout 30000 for client /127.0.0.1:5515
2013-03-29 09:43:25,369 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3d04b400000, negotiated timeout = 30000
2013-03-29 09:43:25,374 - INFO  [main:JMXEnv@105] - expect:0x13db3d04b400000
2013-03-29 09:43:25,374 - INFO  [main:JMXEnv@108] - found:0x13db3d04b400000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3d04b400000
2013-03-29 09:43:25,464 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@275735c4
2013-03-29 09:43:25,469 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:43:25,469 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:43:25,470 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:43:25,470 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5518
2013-03-29 09:43:25,471 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5518
2013-03-29 09:43:25,475 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3d04b400001 with negotiated timeout 10000 for client /127.0.0.1:5518
2013-03-29 09:43:25,475 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3d04b400001, negotiated timeout = 10000
2013-03-29 09:43:25,479 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:43:25,667 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:43:25,692 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:43:25,693 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:43:25,698 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:43:25,699 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:43:25,703 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150017915995197144926578test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:43:25,711 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150017915995197144926578test\current\3c3390.txn
2013-03-29 09:43:25,764 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@3e8f0e73
2013-03-29 09:43:25,766 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:43:25,767 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:43:25,770 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:43:25,774 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5523
2013-03-29 09:43:25,774 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5523
2013-03-29 09:43:25,856 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3d04b400002 with negotiated timeout 10000 for client /127.0.0.1:5523
2013-03-29 09:43:25,857 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3d04b400002, negotiated timeout = 10000
2013-03-29 09:43:25,859 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:43:25,912 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:43:25,914 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:43:25,914 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:43:25,915 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:43:25,915 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:43:25,915 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150021339790731034101928test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:43:25,918 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150021339790731034101928test\current\3c3460.txn
2013-03-29 09:43:25,971 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@38c46dbc
2013-03-29 09:43:25,973 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:43:25,974 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:43:25,974 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:43:25,974 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5528
2013-03-29 09:43:25,975 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5528
2013-03-29 09:43:26,082 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3d04b400003 with negotiated timeout 10000 for client /127.0.0.1:5528
2013-03-29 09:43:26,083 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3d04b400003, negotiated timeout = 10000
2013-03-29 09:43:26,084 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 09:43:26,100 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 09:43:26,102 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 09:43:26,102 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 09:43:26,102 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 09:43:26,103 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 09:43:26,103 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150035911310497452981220test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 09:43:26,105 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150035911310497452981220test\current\3c351a.txn
2013-03-29 09:43:26,165 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7d311feb
2013-03-29 09:43:26,167 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:43:26,167 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:43:26,168 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5533
2013-03-29 09:43:26,169 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:43:26,169 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5533
2013-03-29 09:43:26,241 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3d04b400004 with negotiated timeout 10000 for client /127.0.0.1:5533
2013-03-29 09:43:26,241 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3d04b400004, negotiated timeout = 10000
2013-03-29 09:43:26,298 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@d90364c
2013-03-29 09:43:26,299 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 09:43:26,300 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 09:43:26,300 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 09:43:26,300 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5536
2013-03-29 09:43:26,301 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5536
2013-03-29 09:43:26,308 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3d04b400005 with negotiated timeout 6000 for client /127.0.0.1:5536
2013-03-29 09:43:26,308 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3d04b400005, negotiated timeout = 6000
2013-03-29 09:43:26,400 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3d04b400005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 09:43:26,409 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3d04b400005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 09:43:26,416 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3d04b400005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 09:43:26,424 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3d04b400005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 09:43:26,498 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3d04b400005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 09:43:26,534 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 09:43:26,597 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:43:26,804 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 09:43:26,810 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 09:43:26,888 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 09:43:26,890 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3d04b400005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 09:43:26,907 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3d04b400005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 09:43:26,956 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 09:43:26,964 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 09:43:27,002 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3d04b400005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 09:43:27,042 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 09:43:27,058 - INFO  [pool-17-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 09:43:27,075 - INFO  [pool-17-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 09:43:27,079 - INFO  [New I/O client worker #2-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 09:43:27,101 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 09:43:27,267 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 09:43:27,284 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 09:43:28,108 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5574 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:43:28,114 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5573 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 09:43:28,164 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 09:43:28,164 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 09:43:28,166 - INFO  [New I/O server worker #1-5:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5573 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 09:43:28,166 - INFO  [New I/O server worker #1-5:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 09:43:28,167 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 09:43:28,167 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 09:43:28,168 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 1
2013-03-29 09:43:28,168 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x47235b6c, /127.0.0.1:5574 => /127.0.0.1:60000]
2013-03-29 09:43:28,168 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - Delivering: true
2013-03-29 09:43:28,169 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 09:43:28,170 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 88
2013-03-29 09:43:28,171 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 88
2013-03-29 09:43:28,196 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,196 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,197 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,198 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,200 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,200 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,200 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,201 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,201 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 2
2013-03-29 09:43:28,201 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 1
2013-03-29 09:43:28,201 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 3
2013-03-29 09:43:28,201 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,202 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,202 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,202 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,202 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,203 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,203 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,203 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,204 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,204 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 09:43:28,204 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 223
2013-03-29 09:43:28,205 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,206 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,206 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,206 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,206 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,210 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,210 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,211 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 4
2013-03-29 09:43:28,211 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,211 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,211 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,212 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,212 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,212 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,212 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,213 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 09:43:28,213 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 246
2013-03-29 09:43:28,213 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,214 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,215 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,217 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 212
2013-03-29 09:43:28,217 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 212
2013-03-29 09:43:28,219 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,219 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,220 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 5
2013-03-29 09:43:28,220 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 6
2013-03-29 09:43:28,221 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 7
2013-03-29 09:43:28,220 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,221 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 8
2013-03-29 09:43:28,222 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,222 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,222 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 225
2013-03-29 09:43:28,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 09:43:28,225 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 266
2013-03-29 09:43:28,225 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 267
2013-03-29 09:43:28,225 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,225 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,226 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,226 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 226
2013-03-29 09:43:28,226 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,226 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,226 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,227 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,227 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,227 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,232 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 250
2013-03-29 09:43:28,233 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 252
2013-03-29 09:43:28,274 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,274 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,274 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,274 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,275 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,276 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,276 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,276 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,276 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 9
2013-03-29 09:43:28,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 10
2013-03-29 09:43:28,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 09:43:28,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 424
2013-03-29 09:43:28,279 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,279 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,279 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,282 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,282 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,282 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,282 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,283 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,283 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,283 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 11
2013-03-29 09:43:28,284 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,284 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,284 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,284 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,285 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,285 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,285 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,286 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,286 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 09:43:28,286 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 442
2013-03-29 09:43:28,286 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,287 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,287 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,288 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,288 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,288 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,291 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,292 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 419
2013-03-29 09:43:28,292 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 419
2013-03-29 09:43:28,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 12
2013-03-29 09:43:28,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,294 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,294 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,294 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,294 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 13
2013-03-29 09:43:28,294 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,295 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 14
2013-03-29 09:43:28,295 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,295 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 15
2013-03-29 09:43:28,295 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,295 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,296 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,296 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,296 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,296 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :4
2013-03-29 09:43:28,296 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 471
2013-03-29 09:43:28,297 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 473
2013-03-29 09:43:28,297 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 474
2013-03-29 09:43:28,297 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 475
2013-03-29 09:43:28,297 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 428
2013-03-29 09:43:28,298 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,298 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,298 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 430
2013-03-29 09:43:28,299 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,299 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,303 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 446
2013-03-29 09:43:28,305 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 449
2013-03-29 09:43:28,348 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 479
2013-03-29 09:43:28,358 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 480
2013-03-29 09:43:28,368 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,369 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,369 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 16
2013-03-29 09:43:28,370 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 17
2013-03-29 09:43:28,370 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,370 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 18
2013-03-29 09:43:28,370 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,371 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 19
2013-03-29 09:43:28,372 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,372 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 20
2013-03-29 09:43:28,372 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,372 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,373 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :4
2013-03-29 09:43:28,373 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 571
2013-03-29 09:43:28,373 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 572
2013-03-29 09:43:28,373 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 573
2013-03-29 09:43:28,373 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 574
2013-03-29 09:43:28,375 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,375 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,375 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 21
2013-03-29 09:43:28,375 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,376 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,376 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 09:43:28,376 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 577
2013-03-29 09:43:28,376 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,377 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,377 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,377 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 22
2013-03-29 09:43:28,377 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,377 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 09:43:28,378 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,378 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 09:43:28,379 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :3
2013-03-29 09:43:28,379 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 572
2013-03-29 09:43:28,379 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 577
2013-03-29 09:43:28,379 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 578
2013-03-29 09:43:28,380 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 09:43:28,382 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 09:43:28,382 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 09:43:28,383 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 23
2013-03-29 09:43:28,383 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5574 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 09:43:28,383 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 09:43:28,386 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 0
2013-03-29 09:43:28,386 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1401] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 09:43:28,386 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1403] - Last consumed seq: 531
2013-03-29 09:43:43,005 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 09:43:43,041 - INFO  [New I/O client worker #2-3:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15002
2013-03-29 09:43:43,043 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15001
2013-03-29 09:43:43,045 - INFO  [New I/O client worker #2-1:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15003
2013-03-29 09:43:43,047 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3d04b400005
2013-03-29 09:43:43,057 - INFO  [main:ZooKeeper@679] - Session: 0x13db3d04b400005 closed
2013-03-29 09:43:43,057 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5536 which had sessionid 0x13db3d04b400005
2013-03-29 09:43:43,058 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:43:43,060 - INFO  [New I/O client worker #5-1:HChannelHandler@244] - Channel [id: 0x461f79b5, /127.0.0.1:5560 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 09:43:43,061 - INFO  [New I/O client worker #5-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x461f79b5, /127.0.0.1:5560 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 09:43:43,061 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x1879d52f, /127.0.0.1:5541 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 09:43:43,061 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x1879d52f, /127.0.0.1:5541 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 09:43:43,066 - WARN  [NIOServerFactory-15001:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 09:43:43,066 - INFO  [NIOServerFactory-15001:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:43:43,067 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3d04b400001
2013-03-29 09:43:43,073 - INFO  [main:ZooKeeper@679] - Session: 0x13db3d04b400001 closed
2013-03-29 09:43:43,073 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@349] - caught end of stream exception
EndOfStreamException: Unable to read additional data from client sessionid 0x13db3d04b400001, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:220)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:224)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 09:43:43,074 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:43:43,074 - WARN  [BookieJournal-15001:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:43:43,073 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:43:43,074 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5518 which had sessionid 0x13db3d04b400001
2013-03-29 09:43:43,111 - INFO  [NIOServerFactory-15002:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:43:43,114 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3d04b400002
2013-03-29 09:43:43,132 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5523 which had sessionid 0x13db3d04b400002
2013-03-29 09:43:43,132 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:43:43,132 - INFO  [main:ZooKeeper@679] - Session: 0x13db3d04b400002 closed
2013-03-29 09:43:43,143 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:43:43,143 - WARN  [BookieJournal-15002:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:43:43,164 - INFO  [NIOServerFactory-15003:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 09:43:43,167 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3d04b400003
2013-03-29 09:43:43,190 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5528 which had sessionid 0x13db3d04b400003
2013-03-29 09:43:43,191 - INFO  [main:ZooKeeper@679] - Session: 0x13db3d04b400003 closed
2013-03-29 09:43:43,191 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 09:43:43,192 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:43:43,194 - WARN  [BookieJournal-15003:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 09:43:43,235 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3d04b400004
2013-03-29 09:43:43,256 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5533 which had sessionid 0x13db3d04b400004
2013-03-29 09:43:43,258 - INFO  [main:ZooKeeper@679] - Session: 0x13db3d04b400004 closed
2013-03-29 09:43:43,258 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 09:43:43,259 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:43:43,260 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3d04b400000
2013-03-29 09:43:43,264 - INFO  [main:ZooKeeper@679] - Session: 0x13db3d04b400000 closed
2013-03-29 09:43:43,265 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 09:43:43,265 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5515 which had sessionid 0x13db3d04b400000
2013-03-29 09:43:43,265 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 09:43:43,266 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@234] - Ignoring unexpected runtime exception
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:203)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 09:43:43,267 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 09:43:43,267 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 09:43:43,267 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 09:43:43,267 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 09:43:43,267 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 09:43:43,268 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 09:43:43,268 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 09:43:43,268 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 09:43:43,268 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 09:43:44,269 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 09:43:44,274 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
2013-03-29 10:09:20,814 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 10:09:20,835 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 10:09:21,024 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 10:09:21,036 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:09:21,036 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 10:09:21,038 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 10:09:21,039 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 10:09:21,039 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:09:21,040 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:09:21,041 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:09:21,041 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:09:21,042 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 10:09:21,042 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 10:09:21,044 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 10:09:21,044 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 10:09:21,047 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 10:09:21,047 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 10:09:21,047 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:09:21,065 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test7522091606960105386.junit.dir\version-2 snapdir E:\test\test7522091606960105386.junit.dir\version-2
2013-03-29 10:09:21,077 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 10:09:21,083 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test7522091606960105386.junit.dir\version-2\snapshot.0
2013-03-29 10:09:21,104 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:09:21,105 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5938
2013-03-29 10:09:21,109 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:5938
2013-03-29 10:09:21,111 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 10:09:21,112 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5938 (no session established for client)
2013-03-29 10:09:21,112 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 10:09:21,116 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 10:09:21,116 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 10:09:21,117 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 10:09:21,117 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 10:09:21,117 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 10:09:21,122 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:09:21,123 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 10:09:21,123 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 10:09:21,123 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 10:09:21,124 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:09:21,124 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:09:21,124 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:09:21,125 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:09:21,125 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 10:09:21,125 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 10:09:21,126 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 10:09:21,126 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 10:09:21,126 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 10:09:21,127 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 10:09:21,127 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:09:21,128 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@7ef9f3b2
2013-03-29 10:09:21,146 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:09:21,150 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:09:21,151 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:09:21,152 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5941
2013-03-29 10:09:21,154 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5941
2013-03-29 10:09:21,157 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 10:09:21,214 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3e808c10000 with negotiated timeout 30000 for client /127.0.0.1:5941
2013-03-29 10:09:21,215 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3e808c10000, negotiated timeout = 30000
2013-03-29 10:09:21,221 - INFO  [main:JMXEnv@105] - expect:0x13db3e808c10000
2013-03-29 10:09:21,221 - INFO  [main:JMXEnv@108] - found:0x13db3e808c10000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3e808c10000
2013-03-29 10:09:21,318 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@101e1680
2013-03-29 10:09:21,324 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:09:21,324 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:09:21,324 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:09:21,324 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5944
2013-03-29 10:09:21,325 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5944
2013-03-29 10:09:21,341 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3e808c10001 with negotiated timeout 10000 for client /127.0.0.1:5944
2013-03-29 10:09:21,341 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3e808c10001, negotiated timeout = 10000
2013-03-29 10:09:21,345 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:09:21,519 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:09:21,532 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:09:21,533 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:09:21,536 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:09:21,537 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:09:21,540 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150014094201470333308612test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:09:21,547 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150014094201470333308612test\current\53f0fc.txn
2013-03-29 10:09:21,585 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@756a162a
2013-03-29 10:09:21,587 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:09:21,587 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:09:21,588 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5949
2013-03-29 10:09:21,590 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:09:21,593 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5949
2013-03-29 10:09:21,663 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3e808c10002 with negotiated timeout 10000 for client /127.0.0.1:5949
2013-03-29 10:09:21,664 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3e808c10002, negotiated timeout = 10000
2013-03-29 10:09:21,665 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:09:21,726 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:09:21,729 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:09:21,729 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:09:21,730 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:09:21,731 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:09:21,731 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie1500271505451898092787test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:09:21,736 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie1500271505451898092787test\current\53f1bb.txn
2013-03-29 10:09:21,796 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@348ed7c0
2013-03-29 10:09:21,799 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:09:21,801 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:09:21,802 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5954
2013-03-29 10:09:21,803 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:09:21,804 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5954
2013-03-29 10:09:21,853 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3e808c10003 with negotiated timeout 10000 for client /127.0.0.1:5954
2013-03-29 10:09:21,853 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3e808c10003, negotiated timeout = 10000
2013-03-29 10:09:21,854 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:09:21,870 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:09:21,871 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:09:21,872 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:09:21,873 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:09:21,873 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:09:21,874 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150032155160361285042245test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:09:21,875 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150032155160361285042245test\current\53f247.txn
2013-03-29 10:09:21,928 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7d311feb
2013-03-29 10:09:21,929 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:09:21,930 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:09:21,930 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:09:21,930 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5959
2013-03-29 10:09:21,931 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5959
2013-03-29 10:09:21,952 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3e808c10004 with negotiated timeout 10000 for client /127.0.0.1:5959
2013-03-29 10:09:21,952 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3e808c10004, negotiated timeout = 10000
2013-03-29 10:09:22,010 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@d90364c
2013-03-29 10:09:22,011 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:09:22,012 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:09:22,013 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:09:22,013 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:5962
2013-03-29 10:09:22,013 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:5962
2013-03-29 10:09:22,027 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3e808c10005 with negotiated timeout 6000 for client /127.0.0.1:5962
2013-03-29 10:09:22,027 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3e808c10005, negotiated timeout = 6000
2013-03-29 10:09:22,118 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3e808c10005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 10:09:22,129 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3e808c10005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 10:09:22,141 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3e808c10005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 10:09:22,152 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3e808c10005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 10:09:22,224 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3e808c10005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 10:09:22,255 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 10:09:22,320 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:09:22,522 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:09:22,529 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 10:09:22,620 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 10:09:22,622 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3e808c10005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 10:09:22,673 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3e808c10005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 10:09:22,728 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 10:09:22,738 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 10:09:22,785 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3e808c10005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 10:09:22,811 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 10:09:22,823 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 10:09:22,837 - INFO  [pool-15-thread-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 10:09:22,839 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 10:09:22,842 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 10:09:23,123 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 10:09:23,137 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 10:09:23,918 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6000 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:09:23,920 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:5999 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:09:23,971 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 10:09:23,971 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 10:09:23,973 - INFO  [New I/O server worker #1-5:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:5999 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:09:23,973 - INFO  [New I/O server worker #1-5:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:09:23,974 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 10:09:23,975 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:09:23,975 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 1
2013-03-29 10:09:23,975 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x30a303f8, /127.0.0.1:6000 => /127.0.0.1:60000]
2013-03-29 10:09:23,976 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - Delivering: true
2013-03-29 10:09:23,977 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:23,977 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:23,977 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:23,978 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 10:09:23,978 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 140
2013-03-29 10:09:23,978 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 142
2013-03-29 10:09:23,978 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:23,979 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:23,979 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:23,981 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 142
2013-03-29 10:09:24,101 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:09:24,101 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:09:24,102 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:09:24,102 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:09:24,102 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 1
2013-03-29 10:09:24,106 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:09:24,106 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:09:24,107 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:09:24,107 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:09:24,107 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:09:24,107 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 2
2013-03-29 10:09:24,107 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:09:24,108 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:09:24,108 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:09:24,109 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:09:24,110 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:09:24,110 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:09:24,110 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:09:24,111 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:09:24,111 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,112 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 3
2013-03-29 10:09:24,112 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,112 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 4
2013-03-29 10:09:24,112 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,112 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 5
2013-03-29 10:09:24,113 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:09:24,113 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,113 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,113 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,115 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,116 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,116 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,116 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,117 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,117 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,117 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,117 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:09:24,117 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :3
2013-03-29 10:09:24,118 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 502
2013-03-29 10:09:24,118 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 503
2013-03-29 10:09:24,118 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 504
2013-03-29 10:09:24,118 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,119 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,119 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,120 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,120 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,120 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,120 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,121 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,121 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,121 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:09:24,121 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 477
2013-03-29 10:09:24,126 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 494
2013-03-29 10:09:24,128 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 495
2013-03-29 10:09:24,128 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 496
2013-03-29 10:09:24,131 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 508
2013-03-29 10:09:24,132 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 509
2013-03-29 10:09:24,135 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6000 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:09:24,135 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:09:24,136 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:09:24,137 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:09:24,138 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:09:24,138 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:09:24,139 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:09:24,139 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 0
2013-03-29 10:09:24,140 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1401] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 10:09:24,140 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1403] - Last consumed seq: 501
2013-03-29 10:09:24,141 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,141 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 6
2013-03-29 10:09:24,141 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,141 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 7
2013-03-29 10:09:24,141 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,141 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 8
2013-03-29 10:09:24,141 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,141 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 9
2013-03-29 10:09:24,142 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,142 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,142 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 10
2013-03-29 10:09:24,142 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:24,142 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:09:38,845 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 10:09:38,882 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15002
2013-03-29 10:09:38,884 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15001
2013-03-29 10:09:38,889 - INFO  [New I/O client worker #2-2:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15003
2013-03-29 10:09:38,892 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3e808c10005
2013-03-29 10:09:38,908 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5962 which had sessionid 0x13db3e808c10005
2013-03-29 10:09:38,915 - INFO  [main:ZooKeeper@679] - Session: 0x13db3e808c10005 closed
2013-03-29 10:09:38,917 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:09:38,919 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x1879d52f, /127.0.0.1:5967 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 10:09:38,920 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x1879d52f, /127.0.0.1:5967 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 10:09:38,923 - INFO  [New I/O client worker #4-1:HChannelHandler@244] - Channel [id: 0x2bd30166, /0:0:0:0:0:0:0:0:5985 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 10:09:38,923 - INFO  [New I/O client worker #4-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x2bd30166, /0:0:0:0:0:0:0:0:5985 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 10:09:38,926 - WARN  [NIOServerFactory-15001:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 10:09:38,927 - INFO  [NIOServerFactory-15001:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:09:38,927 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3e808c10001
2013-03-29 10:09:38,939 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5944 which had sessionid 0x13db3e808c10001
2013-03-29 10:09:38,939 - INFO  [main:ZooKeeper@679] - Session: 0x13db3e808c10001 closed
2013-03-29 10:09:38,940 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:09:38,940 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:09:38,941 - WARN  [BookieJournal-15001:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:09:38,969 - WARN  [NIOServerFactory-15002:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 10:09:38,969 - INFO  [NIOServerFactory-15002:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:09:38,969 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3e808c10002
2013-03-29 10:09:38,989 - INFO  [main:ZooKeeper@679] - Session: 0x13db3e808c10002 closed
2013-03-29 10:09:38,989 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:09:38,989 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5949 which had sessionid 0x13db3e808c10002
2013-03-29 10:09:38,990 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:09:38,991 - WARN  [BookieJournal-15002:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:09:39,017 - WARN  [NIOServerFactory-15003:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 10:09:39,018 - INFO  [NIOServerFactory-15003:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:09:39,019 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3e808c10003
2013-03-29 10:09:39,039 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5954 which had sessionid 0x13db3e808c10003
2013-03-29 10:09:39,039 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:09:39,039 - INFO  [main:ZooKeeper@679] - Session: 0x13db3e808c10003 closed
2013-03-29 10:09:39,040 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:09:39,040 - WARN  [BookieJournal-15003:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:09:39,077 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3e808c10004
2013-03-29 10:09:39,109 - INFO  [main:ZooKeeper@679] - Session: 0x13db3e808c10004 closed
2013-03-29 10:09:39,109 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5959 which had sessionid 0x13db3e808c10004
2013-03-29 10:09:39,109 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:09:39,109 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 10:09:39,110 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3e808c10000
2013-03-29 10:09:39,122 - INFO  [main:ZooKeeper@679] - Session: 0x13db3e808c10000 closed
2013-03-29 10:09:39,122 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:5941 which had sessionid 0x13db3e808c10000
2013-03-29 10:09:39,122 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:09:39,123 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 10:09:39,124 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@234] - Ignoring unexpected runtime exception
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:203)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 10:09:39,124 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 10:09:39,125 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 10:09:39,125 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 10:09:39,125 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 10:09:39,126 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 10:09:39,126 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 10:09:39,126 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 10:09:39,126 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 10:09:39,127 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:09:40,130 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 10:09:40,135 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
2013-03-29 10:11:58,155 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 10:11:58,175 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 10:11:58,362 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 10:11:58,372 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:11:58,372 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 10:11:58,373 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 10:11:58,374 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 10:11:58,375 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:11:58,376 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:11:58,377 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:11:58,378 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:11:58,378 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 10:11:58,379 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 10:11:58,379 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 10:11:58,379 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 10:11:58,382 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 10:11:58,382 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 10:11:58,383 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:11:58,400 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test6891477119159335285.junit.dir\version-2 snapdir E:\test\test6891477119159335285.junit.dir\version-2
2013-03-29 10:11:58,413 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 10:11:58,418 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test6891477119159335285.junit.dir\version-2\snapshot.0
2013-03-29 10:11:58,440 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:11:58,441 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6057
2013-03-29 10:11:58,445 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:6057
2013-03-29 10:11:58,448 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 10:11:58,448 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6057 (no session established for client)
2013-03-29 10:11:58,449 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 10:11:58,453 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 10:11:58,454 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 10:11:58,454 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 10:11:58,455 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 10:11:58,455 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 10:11:58,463 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:11:58,463 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 10:11:58,464 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 10:11:58,464 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 10:11:58,465 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:11:58,465 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:11:58,467 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:11:58,467 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:11:58,468 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 10:11:58,468 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 10:11:58,468 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 10:11:58,469 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 10:11:58,469 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 10:11:58,469 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 10:11:58,470 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:11:58,471 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@2d3cd0ba
2013-03-29 10:11:58,485 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:11:58,488 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:11:58,489 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6060
2013-03-29 10:11:58,489 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:11:58,491 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6060
2013-03-29 10:11:58,494 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 10:11:58,554 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea6f580000 with negotiated timeout 30000 for client /127.0.0.1:6060
2013-03-29 10:11:58,555 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ea6f580000, negotiated timeout = 30000
2013-03-29 10:11:58,559 - INFO  [main:JMXEnv@105] - expect:0x13db3ea6f580000
2013-03-29 10:11:58,559 - INFO  [main:JMXEnv@108] - found:0x13db3ea6f580000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3ea6f580000
2013-03-29 10:11:58,662 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@1d939e84
2013-03-29 10:11:58,667 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:11:58,668 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:11:58,669 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:11:58,669 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6063
2013-03-29 10:11:58,669 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6063
2013-03-29 10:11:58,679 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea6f580001 with negotiated timeout 10000 for client /127.0.0.1:6063
2013-03-29 10:11:58,680 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ea6f580001, negotiated timeout = 10000
2013-03-29 10:11:58,683 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:11:58,846 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:11:58,859 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:11:58,860 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:11:58,864 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:11:58,864 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:11:58,867 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150015187984651037311033test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:11:58,874 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150015187984651037311033test\current\56578b.txn
2013-03-29 10:11:58,954 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@4ba6b85d
2013-03-29 10:11:58,956 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:11:58,957 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:11:58,958 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6069
2013-03-29 10:11:58,958 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:11:58,959 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6069
2013-03-29 10:11:59,004 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea6f580002 with negotiated timeout 10000 for client /127.0.0.1:6069
2013-03-29 10:11:59,004 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ea6f580002, negotiated timeout = 10000
2013-03-29 10:11:59,005 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:11:59,022 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:11:59,024 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:11:59,024 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:11:59,025 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:11:59,025 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:11:59,026 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150027511929622565483296test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:11:59,028 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150027511929622565483296test\current\565826.txn
2013-03-29 10:11:59,087 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@74f3d69c
2013-03-29 10:11:59,088 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:11:59,089 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:11:59,089 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:11:59,089 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6074
2013-03-29 10:11:59,090 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6074
2013-03-29 10:11:59,120 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea6f580003 with negotiated timeout 10000 for client /127.0.0.1:6074
2013-03-29 10:11:59,120 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ea6f580003, negotiated timeout = 10000
2013-03-29 10:11:59,121 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:11:59,146 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:11:59,148 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:11:59,148 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:11:59,148 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:11:59,149 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:11:59,149 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150034739062505070988012test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:11:59,151 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150034739062505070988012test\current\5658a1.txn
2013-03-29 10:11:59,203 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@4782fe29
2013-03-29 10:11:59,205 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:11:59,206 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:11:59,206 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:11:59,206 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6079
2013-03-29 10:11:59,207 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6079
2013-03-29 10:11:59,284 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea6f580004 with negotiated timeout 10000 for client /127.0.0.1:6079
2013-03-29 10:11:59,284 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ea6f580004, negotiated timeout = 10000
2013-03-29 10:11:59,335 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@30d6defa
2013-03-29 10:11:59,336 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:11:59,337 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:11:59,337 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:11:59,337 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6082
2013-03-29 10:11:59,338 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6082
2013-03-29 10:11:59,346 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea6f580005 with negotiated timeout 6000 for client /127.0.0.1:6082
2013-03-29 10:11:59,346 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ea6f580005, negotiated timeout = 6000
2013-03-29 10:11:59,431 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea6f580005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 10:11:59,455 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea6f580005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 10:11:59,462 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea6f580005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 10:11:59,470 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea6f580005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 10:11:59,541 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea6f580005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 10:11:59,565 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 10:11:59,630 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:11:59,853 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:11:59,860 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 10:11:59,942 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 10:11:59,943 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea6f580005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 10:11:59,962 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea6f580005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 10:12:00,169 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 10:12:00,185 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 10:12:00,231 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea6f580005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 10:12:00,255 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 10:12:00,267 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 10:12:00,283 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 10:12:00,285 - INFO  [New I/O client worker #2-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 10:12:00,287 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 10:12:00,434 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 10:12:00,466 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 10:12:01,249 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6121 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:12:01,252 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6120 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:12:01,304 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 10:12:01,305 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 10:12:01,306 - INFO  [New I/O server worker #1-5:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6120 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:12:01,306 - INFO  [New I/O server worker #1-5:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:12:01,307 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:12:01,308 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 10:12:01,308 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 1
2013-03-29 10:12:01,308 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x3394ef9f, /127.0.0.1:6121 => /127.0.0.1:60000]
2013-03-29 10:12:01,308 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - Delivering: true
2013-03-29 10:12:01,309 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 10:12:01,309 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 92
2013-03-29 10:12:01,311 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 92
2013-03-29 10:12:01,473 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6121 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:12:01,473 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:12:01,474 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:12:01,474 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 0
2013-03-29 10:12:01,474 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1401] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 10:12:01,475 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1403] - Last consumed seq: 499
2013-03-29 10:12:01,475 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:01,475 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 1
2013-03-29 10:12:09,913 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 10:12:09,936 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 10:12:10,151 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 10:12:10,161 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:12:10,162 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 10:12:10,163 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 10:12:10,163 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 10:12:10,164 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:12:10,165 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:12:10,165 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:12:10,166 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:12:10,166 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 10:12:10,167 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 10:12:10,167 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 10:12:10,168 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 10:12:10,168 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 10:12:10,169 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 10:12:10,169 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:12:10,186 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test8674099391849981733.junit.dir\version-2 snapdir E:\test\test8674099391849981733.junit.dir\version-2
2013-03-29 10:12:10,199 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15004
2013-03-29 10:12:10,206 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test8674099391849981733.junit.dir\version-2\snapshot.0
2013-03-29 10:12:10,228 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15004
2013-03-29 10:12:10,230 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6140
2013-03-29 10:12:10,233 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:6140
2013-03-29 10:12:10,236 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 10:12:10,237 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6140 (no session established for client)
2013-03-29 10:12:10,237 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 10:12:10,255 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 10:12:10,255 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 10:12:10,256 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 10:12:10,256 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 10:12:10,256 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 10:12:10,262 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:12:10,262 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 10:12:10,262 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 10:12:10,263 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 10:12:10,263 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:12:10,263 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:12:10,264 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:12:10,264 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:12:10,265 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 10:12:10,265 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 10:12:10,265 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 10:12:10,266 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 10:12:10,267 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 10:12:10,267 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 10:12:10,267 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:12:10,269 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15004 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@118ac3cd
2013-03-29 10:12:10,281 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15004
2013-03-29 10:12:10,285 - INFO  [main-SendThread(127.0.0.1:15004):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:10,286 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6143
2013-03-29 10:12:10,286 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15004, initiating session
2013-03-29 10:12:10,288 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6143
2013-03-29 10:12:10,290 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 10:12:10,351 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea9d650000 with negotiated timeout 30000 for client /127.0.0.1:6143
2013-03-29 10:12:10,352 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15004, sessionid = 0x13db3ea9d650000, negotiated timeout = 30000
2013-03-29 10:12:10,356 - INFO  [main:JMXEnv@105] - expect:0x13db3ea9d650000
2013-03-29 10:12:10,356 - INFO  [main:JMXEnv@108] - found:0x13db3ea9d650000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3ea9d650000
2013-03-29 10:12:10,563 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15004 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@101e1680
2013-03-29 10:12:10,567 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15004
2013-03-29 10:12:10,567 - INFO  [main-SendThread(127.0.0.1:15004):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:10,568 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15004, initiating session
2013-03-29 10:12:10,568 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6146
2013-03-29 10:12:10,569 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6146
2013-03-29 10:12:10,619 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea9d650001 with negotiated timeout 10000 for client /127.0.0.1:6146
2013-03-29 10:12:10,619 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15004, sessionid = 0x13db3ea9d650001, negotiated timeout = 10000
2013-03-29 10:12:10,622 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:12:10,809 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:12:10,837 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:12:10,837 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:12:10,843 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:12:10,844 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:12:10,849 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150055957651420236077339test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:12:10,857 - INFO  [BookieJournal-15005:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150055957651420236077339test\current\56865b.txn
2013-03-29 10:12:10,968 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15004 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@55168524
2013-03-29 10:12:10,970 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15004
2013-03-29 10:12:10,970 - INFO  [main-SendThread(127.0.0.1:15004):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:10,973 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15004, initiating session
2013-03-29 10:12:10,978 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6151
2013-03-29 10:12:10,979 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6151
2013-03-29 10:12:11,030 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea9d650002 with negotiated timeout 10000 for client /127.0.0.1:6151
2013-03-29 10:12:11,030 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15004, sessionid = 0x13db3ea9d650002, negotiated timeout = 10000
2013-03-29 10:12:11,054 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:12:11,112 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:12:11,115 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:12:11,116 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:12:11,117 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:12:11,118 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:12:11,119 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150067914898110454765976test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:12:11,156 - INFO  [BookieJournal-15006:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150067914898110454765976test\current\568787.txn
2013-03-29 10:12:11,216 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15004 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@1bd665a3
2013-03-29 10:12:11,218 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15004
2013-03-29 10:12:11,218 - INFO  [main-SendThread(127.0.0.1:15004):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:11,219 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15004, initiating session
2013-03-29 10:12:11,219 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6156
2013-03-29 10:12:11,219 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6156
2013-03-29 10:12:11,242 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea9d650003 with negotiated timeout 10000 for client /127.0.0.1:6156
2013-03-29 10:12:11,242 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15004, sessionid = 0x13db3ea9d650003, negotiated timeout = 10000
2013-03-29 10:12:11,243 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:12:11,260 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:12:11,262 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:12:11,262 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:12:11,263 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:12:11,263 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:12:11,264 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150073732654798757181347test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:12:11,266 - INFO  [BookieJournal-15007:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150073732654798757181347test\current\5687f5.txn
2013-03-29 10:12:11,338 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15004 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7c42860
2013-03-29 10:12:11,341 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15004
2013-03-29 10:12:11,342 - INFO  [main-SendThread(127.0.0.1:15004):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:11,343 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6161
2013-03-29 10:12:11,343 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15004, initiating session
2013-03-29 10:12:11,344 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6161
2013-03-29 10:12:11,367 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea9d650004 with negotiated timeout 10000 for client /127.0.0.1:6161
2013-03-29 10:12:11,367 - INFO  [main-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15004, sessionid = 0x13db3ea9d650004, negotiated timeout = 10000
2013-03-29 10:12:11,426 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15004 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@6c5cce75
2013-03-29 10:12:11,428 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15004
2013-03-29 10:12:11,428 - INFO  [Thread-7-SendThread(127.0.0.1:15004):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:11,429 - INFO  [Thread-7-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15004, initiating session
2013-03-29 10:12:11,429 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6164
2013-03-29 10:12:11,429 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6164
2013-03-29 10:12:11,435 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ea9d650005 with negotiated timeout 6000 for client /127.0.0.1:6164
2013-03-29 10:12:11,435 - INFO  [Thread-7-SendThread(127.0.0.1:15004):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15004, sessionid = 0x13db3ea9d650005, negotiated timeout = 6000
2013-03-29 10:12:11,518 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea9d650005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 10:12:11,537 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea9d650005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 10:12:11,543 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea9d650005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 10:12:11,551 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea9d650005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 10:12:11,637 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ea9d650005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 10:12:11,671 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 10:12:11,739 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:12:11,957 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:12:11,964 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 10:12:13,106 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6190 succeed - its subscription data is State : { consumeSeqId: local:499 };Preferences : { System Preferences : [] };
2013-03-29 10:12:13,107 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6191 succeed - its subscription data is State : { consumeSeqId: local:499 };Preferences : { System Preferences : [] };
2013-03-29 10:12:13,159 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 10:12:13,161 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 10:12:13,163 - INFO  [New I/O server worker #1-2:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6191 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:12:13,163 - INFO  [New I/O server worker #1-2:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:12:13,163 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 1
2013-03-29 10:12:13,164 - INFO  [New I/O server worker #1-2:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:12:13,164 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x5a3dfc08, /127.0.0.1:6190 => /127.0.0.1:60000]
2013-03-29 10:12:13,164 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 10:12:13,164 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - Delivering: true
2013-03-29 10:12:13,165 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 10:12:13,165 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 625
2013-03-29 10:12:13,166 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 625
2013-03-29 10:12:13,180 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,180 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,181 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,181 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,182 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,183 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,183 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,183 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,183 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 1
2013-03-29 10:12:13,184 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,185 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 2
2013-03-29 10:12:13,185 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,185 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,185 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,186 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,186 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,187 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,187 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 10:12:13,187 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 715
2013-03-29 10:12:13,187 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 716
2013-03-29 10:12:13,188 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,188 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,189 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,189 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,192 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,192 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,193 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 3
2013-03-29 10:12:13,193 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,193 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,194 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,194 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,195 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 4
2013-03-29 10:12:13,195 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,195 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,195 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,196 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,196 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,196 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 10:12:13,196 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 735
2013-03-29 10:12:13,197 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 737
2013-03-29 10:12:13,197 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,197 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,198 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,198 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,208 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 709
2013-03-29 10:12:13,209 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 710
2013-03-29 10:12:13,212 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 719
2013-03-29 10:12:13,219 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,220 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,220 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 5
2013-03-29 10:12:13,220 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,220 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 6
2013-03-29 10:12:13,220 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,221 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 7
2013-03-29 10:12:13,221 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,221 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,222 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,222 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,222 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,222 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 739
2013-03-29 10:12:13,222 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :3
2013-03-29 10:12:13,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 786
2013-03-29 10:12:13,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 787
2013-03-29 10:12:13,223 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 788
2013-03-29 10:12:13,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,224 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,228 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,228 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,231 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,232 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,232 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 8
2013-03-29 10:12:13,232 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,233 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 9
2013-03-29 10:12:13,233 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,233 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,233 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,234 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,234 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 10:12:13,234 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 811
2013-03-29 10:12:13,235 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 812
2013-03-29 10:12:13,235 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,235 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,254 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 805
2013-03-29 10:12:13,261 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,262 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,262 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,262 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,263 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,263 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,264 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,264 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 10
2013-03-29 10:12:13,264 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,264 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 11
2013-03-29 10:12:13,265 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,265 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,265 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,266 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,266 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 12
2013-03-29 10:12:13,266 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,267 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,267 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,267 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 10:12:13,267 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 873
2013-03-29 10:12:13,268 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 875
2013-03-29 10:12:13,268 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,269 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,274 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,274 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,274 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 13
2013-03-29 10:12:13,276 - INFO  [New I/O server worker #1-1:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 14
2013-03-29 10:12:13,276 - INFO  [New I/O server worker #1-1:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 15
2013-03-29 10:12:13,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,277 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 10:12:13,278 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 890
2013-03-29 10:12:13,279 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,279 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,279 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,279 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,280 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,280 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,284 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,284 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,285 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,285 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,285 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,285 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,286 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,286 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,286 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,286 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,286 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 16
2013-03-29 10:12:13,287 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,287 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,287 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,287 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,288 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,288 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,288 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,288 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 17
2013-03-29 10:12:13,289 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,289 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,289 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,289 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 10:12:13,289 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 916
2013-03-29 10:12:13,290 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 918
2013-03-29 10:12:13,290 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,290 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,290 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,291 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 872
2013-03-29 10:12:13,291 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,291 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,292 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 878
2013-03-29 10:12:13,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 18
2013-03-29 10:12:13,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,293 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,294 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,294 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,301 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 19
2013-03-29 10:12:13,303 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,303 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 20
2013-03-29 10:12:13,303 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,303 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,304 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,304 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,304 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 21
2013-03-29 10:12:13,304 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,304 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 22
2013-03-29 10:12:13,305 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,305 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,305 - INFO  [New I/O server worker #1-1:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 23
2013-03-29 10:12:13,305 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 873
2013-03-29 10:12:13,306 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,306 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :5
2013-03-29 10:12:13,306 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 928
2013-03-29 10:12:13,306 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 930
2013-03-29 10:12:13,307 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 931
2013-03-29 10:12:13,307 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 933
2013-03-29 10:12:13,307 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 934
2013-03-29 10:12:13,308 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,308 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,309 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,311 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 913
2013-03-29 10:12:13,312 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 914
2013-03-29 10:12:13,328 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 916
2013-03-29 10:12:13,328 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 924
2013-03-29 10:12:13,329 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 925
2013-03-29 10:12:13,333 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 928
2013-03-29 10:12:13,334 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 937
2013-03-29 10:12:13,334 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 937
2013-03-29 10:12:13,348 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:13,348 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,349 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 24
2013-03-29 10:12:13,349 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,349 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 25
2013-03-29 10:12:13,349 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,350 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 26
2013-03-29 10:12:13,350 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:13,350 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 27
2013-03-29 10:12:13,350 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:13,350 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,351 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,351 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:13,351 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :4
2013-03-29 10:12:13,351 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 1012
2013-03-29 10:12:13,352 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 1013
2013-03-29 10:12:13,352 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 1014
2013-03-29 10:12:13,352 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 1015
2013-03-29 10:12:13,352 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,352 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:13,368 - INFO  [New I/O server worker #1-1:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6190 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:12:13,368 - INFO  [New I/O server worker #1-1:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:12:13,369 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 0
2013-03-29 10:12:13,369 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1401] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 10:12:13,369 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1403] - Last consumed seq: 982
2013-03-29 10:12:16,130 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 10:12:16,162 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15002
2013-03-29 10:12:16,164 - INFO  [New I/O client worker #2-2:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15001
2013-03-29 10:12:16,165 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15003
2013-03-29 10:12:16,167 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea6f580005
2013-03-29 10:12:16,178 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea6f580005 closed
2013-03-29 10:12:16,178 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6082 which had sessionid 0x13db3ea6f580005
2013-03-29 10:12:16,178 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:16,182 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x293e2817, /127.0.0.1:6169 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 10:12:16,182 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x293e2817, /127.0.0.1:6169 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 10:12:16,189 - INFO  [New I/O client worker #4-1:HChannelHandler@244] - Channel [id: 0x0b05be25, /127.0.0.1:6106 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 10:12:16,189 - INFO  [New I/O client worker #4-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x0b05be25, /127.0.0.1:6106 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 10:12:16,190 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x4da7252d, /127.0.0.1:6088 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 10:12:16,190 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x4da7252d, /127.0.0.1:6088 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 10:12:16,191 - INFO  [New I/O client worker #5-1:HChannelHandler@244] - Channel [id: 0x6dadd89d, /127.0.0.1:6176 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 10:12:16,191 - INFO  [New I/O client worker #5-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x6dadd89d, /127.0.0.1:6176 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 10:12:16,201 - INFO  [NIOServerFactory-15001:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:12:16,202 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea6f580001
2013-03-29 10:12:16,211 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea6f580001 closed
2013-03-29 10:12:16,211 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:16,211 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6063 which had sessionid 0x13db3ea6f580001
2013-03-29 10:12:16,211 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:12:16,213 - WARN  [BookieJournal-15001:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:12:16,241 - INFO  [NIOServerFactory-15002:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:12:16,242 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea6f580002
2013-03-29 10:12:16,261 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6069 which had sessionid 0x13db3ea6f580002
2013-03-29 10:12:16,261 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:16,261 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea6f580002 closed
2013-03-29 10:12:16,261 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:12:16,261 - WARN  [BookieJournal-15002:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:12:16,291 - WARN  [NIOServerFactory-15003:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.ClosedChannelException
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:211)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:146)
2013-03-29 10:12:16,292 - INFO  [NIOServerFactory-15003:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:12:16,294 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea6f580003
2013-03-29 10:12:16,311 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6074 which had sessionid 0x13db3ea6f580003
2013-03-29 10:12:16,313 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea6f580003 closed
2013-03-29 10:12:16,313 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:12:16,314 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:16,314 - WARN  [BookieJournal-15003:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:12:16,349 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea6f580004
2013-03-29 10:12:16,369 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6079 which had sessionid 0x13db3ea6f580004
2013-03-29 10:12:16,369 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea6f580004 closed
2013-03-29 10:12:16,370 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 10:12:16,372 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:16,374 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea6f580000
2013-03-29 10:12:16,386 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6060 which had sessionid 0x13db3ea6f580000
2013-03-29 10:12:16,386 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea6f580000 closed
2013-03-29 10:12:16,387 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 10:12:16,388 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@236] - Ignoring exception
java.nio.channels.ClosedChannelException
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:211)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:204)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 10:12:16,388 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 10:12:16,388 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 10:12:16,388 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 10:12:16,389 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 10:12:16,389 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 10:12:16,389 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 10:12:16,389 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:16,389 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 10:12:16,390 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 10:12:16,390 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:12:17,392 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 10:12:17,396 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
2013-03-29 10:12:28,080 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 10:12:28,102 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea9d650005
2013-03-29 10:12:28,117 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea9d650005 closed
2013-03-29 10:12:28,118 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6164 which had sessionid 0x13db3ea9d650005
2013-03-29 10:12:28,119 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:28,130 - WARN  [NIOServerFactory-15005:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.ClosedChannelException
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:211)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:146)
2013-03-29 10:12:28,131 - INFO  [NIOServerFactory-15005:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:12:28,132 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea9d650001
2013-03-29 10:12:28,142 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6146 which had sessionid 0x13db3ea9d650001
2013-03-29 10:12:28,143 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea9d650001 closed
2013-03-29 10:12:28,144 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:28,144 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:12:28,144 - WARN  [BookieJournal-15005:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:12:28,190 - INFO  [NIOServerFactory-15006:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:12:28,198 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea9d650002
2013-03-29 10:12:28,198 - ERROR [main-EventThread:ZkUtils$3@162] - ZK error syncing nodes when getting children: 
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)
	at org.apache.bookkeeper.util.ZkUtils$3.processResult(ZkUtils.java:163)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:619)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:497)
2013-03-29 10:12:28,199 - WARN  [GarbageCollectorThread:ScanAndCompareGarbageCollector@103] - Exception when iterating over the metadata {}
java.io.IOException: Error on getting children from node /ledgers
	at org.apache.bookkeeper.util.ZkUtils.getChildrenInSingleNode(ZkUtils.java:140)
	at org.apache.bookkeeper.meta.FlatLedgerManager$2.next(FlatLedgerManager.java:145)
	at org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector.gc(ScanAndCompareGarbageCollector.java:76)
	at org.apache.bookkeeper.bookie.GarbageCollectorThread.doGcLedgers(GarbageCollectorThread.java:302)
	at org.apache.bookkeeper.bookie.GarbageCollectorThread.run(GarbageCollectorThread.java:271)
2013-03-29 10:12:28,218 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6151 which had sessionid 0x13db3ea9d650002
2013-03-29 10:12:28,218 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea9d650002 closed
2013-03-29 10:12:28,219 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:12:28,220 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:28,234 - WARN  [BookieJournal-15006:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:12:28,258 - WARN  [NIOServerFactory-15007:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 10:12:28,259 - INFO  [NIOServerFactory-15007:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:12:28,259 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea9d650003
2013-03-29 10:12:28,282 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6156 which had sessionid 0x13db3ea9d650003
2013-03-29 10:12:28,282 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:28,282 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea9d650003 closed
2013-03-29 10:12:28,283 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:12:28,283 - WARN  [BookieJournal-15007:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:12:28,328 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea9d650004
2013-03-29 10:12:28,350 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea9d650004 closed
2013-03-29 10:12:28,350 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6161 which had sessionid 0x13db3ea9d650004
2013-03-29 10:12:28,350 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:28,350 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 10:12:28,351 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ea9d650000
2013-03-29 10:12:28,358 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ea9d650000 closed
2013-03-29 10:12:28,359 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6143 which had sessionid 0x13db3ea9d650000
2013-03-29 10:12:28,358 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:12:28,359 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 10:12:28,362 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15004:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 10:12:28,363 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 10:12:28,364 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 10:12:28,365 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 10:12:28,366 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 10:12:28,366 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 10:12:28,366 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 10:12:28,367 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 10:12:28,369 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15004
2013-03-29 10:12:29,372 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 10:12:29,377 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
2013-03-29 10:12:50,774 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 10:12:50,794 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 10:12:50,973 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 10:12:50,984 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:12:50,985 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 10:12:50,988 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 10:12:50,989 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 10:12:50,990 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:12:50,990 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:12:50,991 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:12:50,992 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:12:50,993 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 10:12:50,993 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 10:12:50,993 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 10:12:50,994 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 10:12:50,994 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 10:12:50,994 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 10:12:50,995 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:12:51,011 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test6474117596609152848.junit.dir\version-2 snapdir E:\test\test6474117596609152848.junit.dir\version-2
2013-03-29 10:12:51,023 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 10:12:51,029 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test6474117596609152848.junit.dir\version-2\snapshot.0
2013-03-29 10:12:51,050 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:12:51,051 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6214
2013-03-29 10:12:51,055 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:6214
2013-03-29 10:12:51,057 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 10:12:51,058 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6214 (no session established for client)
2013-03-29 10:12:51,058 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 10:12:51,062 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 10:12:51,063 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 10:12:51,063 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 10:12:51,063 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 10:12:51,063 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 10:12:51,068 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:12:51,069 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 10:12:51,069 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 10:12:51,069 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 10:12:51,070 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:12:51,070 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:12:51,070 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:12:51,071 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:12:51,071 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 10:12:51,071 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 10:12:51,072 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 10:12:51,072 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 10:12:51,072 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 10:12:51,073 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 10:12:51,073 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:12:51,074 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@3e374059
2013-03-29 10:12:51,089 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:12:51,092 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:51,093 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6217
2013-03-29 10:12:51,093 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:12:51,096 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6217
2013-03-29 10:12:51,109 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 10:12:51,161 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3eb3cdb0000 with negotiated timeout 30000 for client /127.0.0.1:6217
2013-03-29 10:12:51,161 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3eb3cdb0000, negotiated timeout = 30000
2013-03-29 10:12:51,165 - INFO  [main:JMXEnv@105] - expect:0x13db3eb3cdb0000
2013-03-29 10:12:51,166 - INFO  [main:JMXEnv@108] - found:0x13db3eb3cdb0000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3eb3cdb0000
2013-03-29 10:12:51,266 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@159d5cf4
2013-03-29 10:12:51,271 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:12:51,272 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:51,272 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:12:51,272 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6220
2013-03-29 10:12:51,273 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6220
2013-03-29 10:12:51,285 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3eb3cdb0001 with negotiated timeout 10000 for client /127.0.0.1:6220
2013-03-29 10:12:51,285 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3eb3cdb0001, negotiated timeout = 10000
2013-03-29 10:12:51,288 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:12:51,448 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:12:51,463 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:12:51,463 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:12:51,467 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:12:51,468 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:12:51,471 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150016937582737669652628test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:12:51,477 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150016937582737669652628test\current\572506.txn
2013-03-29 10:12:51,550 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@49341f0a
2013-03-29 10:12:51,552 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:12:51,553 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:51,554 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:12:51,554 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6225
2013-03-29 10:12:51,562 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6225
2013-03-29 10:12:51,598 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3eb3cdb0002 with negotiated timeout 10000 for client /127.0.0.1:6225
2013-03-29 10:12:51,598 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3eb3cdb0002, negotiated timeout = 10000
2013-03-29 10:12:51,599 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:12:51,619 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:12:51,620 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:12:51,620 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:12:51,621 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:12:51,621 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:12:51,622 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150028259191378213403589test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:12:51,623 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150028259191378213403589test\current\572599.txn
2013-03-29 10:12:51,674 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@6ee38785
2013-03-29 10:12:51,675 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:12:51,676 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:51,676 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:12:51,676 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6230
2013-03-29 10:12:51,677 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6230
2013-03-29 10:12:51,697 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3eb3cdb0003 with negotiated timeout 10000 for client /127.0.0.1:6230
2013-03-29 10:12:51,698 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3eb3cdb0003, negotiated timeout = 10000
2013-03-29 10:12:51,699 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:12:51,716 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:12:51,718 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:12:51,718 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:12:51,719 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:12:51,719 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:12:51,719 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150037716586865276044910test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:12:51,721 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150037716586865276044910test\current\5725fb.txn
2013-03-29 10:12:51,788 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7c42860
2013-03-29 10:12:51,790 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:12:51,791 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:51,791 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:12:51,791 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6235
2013-03-29 10:12:51,792 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6235
2013-03-29 10:12:51,814 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3eb3cdb0004 with negotiated timeout 10000 for client /127.0.0.1:6235
2013-03-29 10:12:51,815 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3eb3cdb0004, negotiated timeout = 10000
2013-03-29 10:12:51,868 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@6c5cce75
2013-03-29 10:12:51,869 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:12:51,869 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:12:51,870 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:12:51,870 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6238
2013-03-29 10:12:51,870 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6238
2013-03-29 10:12:51,898 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3eb3cdb0005, negotiated timeout = 6000
2013-03-29 10:12:51,898 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3eb3cdb0005 with negotiated timeout 6000 for client /127.0.0.1:6238
2013-03-29 10:12:51,975 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3eb3cdb0005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 10:12:51,990 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3eb3cdb0005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 10:12:52,001 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3eb3cdb0005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 10:12:52,014 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3eb3cdb0005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 10:12:52,094 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3eb3cdb0005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 10:12:52,133 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 10:12:52,193 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:12:52,406 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:12:52,414 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 10:12:52,501 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 10:12:52,502 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3eb3cdb0005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 10:12:52,517 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3eb3cdb0005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 10:12:52,562 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 10:12:52,574 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 10:12:52,717 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3eb3cdb0005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 10:12:52,751 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 10:12:52,763 - INFO  [pool-14-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 10:12:52,779 - INFO  [pool-14-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 10:12:52,780 - INFO  [New I/O client worker #2-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 10:12:52,782 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 10:12:52,991 - INFO  [pool-14-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 10:12:53,032 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 10:12:53,890 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6275 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:12:53,892 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6276 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:12:53,943 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 10:12:53,943 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 10:12:53,945 - INFO  [New I/O server worker #1-5:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6276 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:12:53,946 - INFO  [New I/O server worker #1-5:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:12:53,947 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:12:53,947 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 10:12:53,947 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 1
2013-03-29 10:12:53,947 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x1580f504, /127.0.0.1:6275 => /127.0.0.1:60000]
2013-03-29 10:12:53,948 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - Delivering: true
2013-03-29 10:12:53,949 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 10:12:53,949 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 116
2013-03-29 10:12:53,950 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 116
2013-03-29 10:12:54,009 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,010 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,012 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,012 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,012 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 1
2013-03-29 10:12:54,012 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,012 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,013 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,013 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,013 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,013 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,013 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,014 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,014 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 10:12:54,014 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 317
2013-03-29 10:12:54,014 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,015 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,015 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,015 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,020 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,020 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,020 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 2
2013-03-29 10:12:54,021 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,021 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,021 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,021 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,022 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 3
2013-03-29 10:12:54,022 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,022 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,022 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,023 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,023 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 10:12:54,023 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 340
2013-03-29 10:12:54,024 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 342
2013-03-29 10:12:54,024 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,024 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,025 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,032 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 311
2013-03-29 10:12:54,037 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 319
2013-03-29 10:12:54,039 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 319
2013-03-29 10:12:54,044 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 344
2013-03-29 10:12:54,061 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,061 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,063 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,063 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,063 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,064 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,064 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 4
2013-03-29 10:12:54,064 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 5
2013-03-29 10:12:54,064 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,064 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,065 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,065 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,065 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 6
2013-03-29 10:12:54,065 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 7
2013-03-29 10:12:54,066 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,066 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,066 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,066 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,067 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,067 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 10:12:54,067 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 442
2013-03-29 10:12:54,067 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 444
2013-03-29 10:12:54,068 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,068 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,068 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,069 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,073 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,074 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,074 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 8
2013-03-29 10:12:54,074 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,074 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 9
2013-03-29 10:12:54,075 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,075 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,075 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,075 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,076 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,076 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,076 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,076 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :2
2013-03-29 10:12:54,076 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 469
2013-03-29 10:12:54,077 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 470
2013-03-29 10:12:54,077 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,077 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,078 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,081 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 437
2013-03-29 10:12:54,085 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 447
2013-03-29 10:12:54,086 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,087 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,087 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:12:54,087 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,087 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 10
2013-03-29 10:12:54,087 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 11
2013-03-29 10:12:54,088 - INFO  [New I/O server worker #1-4:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 12
2013-03-29 10:12:54,088 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:12:54,089 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,089 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,090 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,090 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,090 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,091 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,091 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,092 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,092 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:12:54,092 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :1
2013-03-29 10:12:54,092 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1446] - Resend: 503
2013-03-29 10:12:54,092 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,093 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,093 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,093 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,094 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,094 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,094 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,094 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1441] - the size of retry MessageQueue :0
2013-03-29 10:12:54,095 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 472
2013-03-29 10:12:54,096 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 473
2013-03-29 10:12:54,104 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6275 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:12:54,104 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:12:54,105 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:12:54,106 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 0
2013-03-29 10:12:54,106 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1401] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 10:12:54,106 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1403] - Last consumed seq: 491
2013-03-29 10:12:54,107 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,107 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 13
2013-03-29 10:12:54,107 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:12:54,107 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 14
2013-03-29 10:13:08,771 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 10:13:08,809 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15002
2013-03-29 10:13:08,811 - INFO  [New I/O client worker #2-2:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15001
2013-03-29 10:13:08,813 - INFO  [New I/O client worker #2-1:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15003
2013-03-29 10:13:08,815 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3eb3cdb0005
2013-03-29 10:13:08,825 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6238 which had sessionid 0x13db3eb3cdb0005
2013-03-29 10:13:08,830 - INFO  [main:ZooKeeper@679] - Session: 0x13db3eb3cdb0005 closed
2013-03-29 10:13:08,834 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:13:08,836 - INFO  [New I/O client worker #5-1:HChannelHandler@244] - Channel [id: 0x6f454f66, /127.0.0.1:6262 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 10:13:08,836 - INFO  [New I/O client worker #5-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x6f454f66, /127.0.0.1:6262 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 10:13:08,839 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x39c2648b, /127.0.0.1:6243 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 10:13:08,839 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x39c2648b, /127.0.0.1:6243 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 10:13:08,844 - INFO  [NIOServerFactory-15001:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:13:08,844 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3eb3cdb0001
2013-03-29 10:13:08,854 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6220 which had sessionid 0x13db3eb3cdb0001
2013-03-29 10:13:08,854 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:13:08,854 - INFO  [main:ZooKeeper@679] - Session: 0x13db3eb3cdb0001 closed
2013-03-29 10:13:08,855 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:13:08,856 - WARN  [BookieJournal-15001:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:13:08,875 - WARN  [NIOServerFactory-15002:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 10:13:08,876 - INFO  [NIOServerFactory-15002:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:13:08,876 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3eb3cdb0002
2013-03-29 10:13:08,896 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6225 which had sessionid 0x13db3eb3cdb0002
2013-03-29 10:13:08,896 - INFO  [main:ZooKeeper@679] - Session: 0x13db3eb3cdb0002 closed
2013-03-29 10:13:08,896 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:13:08,897 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:13:08,897 - WARN  [BookieJournal-15002:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:13:08,927 - INFO  [NIOServerFactory-15003:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:13:08,928 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3eb3cdb0003
2013-03-29 10:13:08,950 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6230 which had sessionid 0x13db3eb3cdb0003
2013-03-29 10:13:08,950 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:13:08,950 - INFO  [main:ZooKeeper@679] - Session: 0x13db3eb3cdb0003 closed
2013-03-29 10:13:08,951 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:13:08,951 - WARN  [BookieJournal-15003:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:13:08,967 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3eb3cdb0004
2013-03-29 10:13:08,988 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6235 which had sessionid 0x13db3eb3cdb0004
2013-03-29 10:13:08,988 - INFO  [main:ZooKeeper@679] - Session: 0x13db3eb3cdb0004 closed
2013-03-29 10:13:08,988 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 10:13:08,989 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:13:08,989 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3eb3cdb0000
2013-03-29 10:13:09,000 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6217 which had sessionid 0x13db3eb3cdb0000
2013-03-29 10:13:09,001 - INFO  [main:ZooKeeper@679] - Session: 0x13db3eb3cdb0000 closed
2013-03-29 10:13:09,001 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 10:13:09,002 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@236] - Ignoring exception
java.nio.channels.ClosedChannelException
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:211)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:204)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 10:13:09,003 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 10:13:09,003 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 10:13:09,003 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 10:13:09,004 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 10:13:09,004 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 10:13:09,004 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 10:13:09,004 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:13:09,005 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 10:13:09,005 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 10:13:09,005 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:13:09,006 - INFO  [SessionTracker:SessionTrackerImpl@162] - SessionTrackerImpl exited loop!
2013-03-29 10:13:10,016 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 10:13:10,021 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
2013-03-29 10:14:38,399 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 10:14:38,419 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 10:14:38,595 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 10:14:38,607 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:14:38,608 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 10:14:38,611 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 10:14:38,612 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 10:14:38,612 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:14:38,613 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:14:38,613 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:14:38,614 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:14:38,614 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 10:14:38,615 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 10:14:38,615 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 10:14:38,616 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 10:14:38,616 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 10:14:38,617 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 10:14:38,617 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:14:38,633 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test3676958755827257858.junit.dir\version-2 snapdir E:\test\test3676958755827257858.junit.dir\version-2
2013-03-29 10:14:38,646 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 10:14:38,651 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test3676958755827257858.junit.dir\version-2\snapshot.0
2013-03-29 10:14:38,673 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:14:38,674 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6315
2013-03-29 10:14:38,678 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:6315
2013-03-29 10:14:38,680 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 10:14:38,681 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6315 (no session established for client)
2013-03-29 10:14:38,681 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 10:14:38,686 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 10:14:38,687 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 10:14:38,687 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 10:14:38,688 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 10:14:38,688 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 10:14:38,695 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:14:38,696 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 10:14:38,697 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 10:14:38,697 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 10:14:38,697 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:14:38,698 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:14:38,700 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:14:38,700 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:14:38,700 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 10:14:38,701 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 10:14:38,701 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 10:14:38,701 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 10:14:38,702 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 10:14:38,702 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 10:14:38,702 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:14:38,704 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@792cc6d9
2013-03-29 10:14:38,721 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:14:38,725 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:14:38,726 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6318
2013-03-29 10:14:38,726 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:14:38,729 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6318
2013-03-29 10:14:38,732 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 10:14:38,883 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ece1410000 with negotiated timeout 30000 for client /127.0.0.1:6318
2013-03-29 10:14:38,884 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ece1410000, negotiated timeout = 30000
2013-03-29 10:14:38,890 - INFO  [main:JMXEnv@105] - expect:0x13db3ece1410000
2013-03-29 10:14:38,890 - INFO  [main:JMXEnv@108] - found:0x13db3ece1410000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3ece1410000
2013-03-29 10:14:38,988 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@1d939e84
2013-03-29 10:14:38,989 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:14:38,990 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:14:38,990 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:14:38,990 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6321
2013-03-29 10:14:38,991 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6321
2013-03-29 10:14:38,994 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ece1410001 with negotiated timeout 10000 for client /127.0.0.1:6321
2013-03-29 10:14:38,994 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ece1410001, negotiated timeout = 10000
2013-03-29 10:14:38,997 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:14:39,161 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:14:39,175 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:14:39,175 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:14:39,180 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:14:39,180 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:14:39,183 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150018456061397165319377test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:14:39,190 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150018456061397165319377test\current\58c9c6.txn
2013-03-29 10:14:39,269 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@49341f0a
2013-03-29 10:14:39,271 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:14:39,271 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:14:39,274 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6326
2013-03-29 10:14:39,274 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:14:39,274 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6326
2013-03-29 10:14:39,380 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ece1410002 with negotiated timeout 10000 for client /127.0.0.1:6326
2013-03-29 10:14:39,383 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ece1410002, negotiated timeout = 10000
2013-03-29 10:14:39,387 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:14:39,428 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:14:39,430 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:14:39,430 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:14:39,430 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:14:39,431 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:14:39,431 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie15002372062571273862464test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:14:39,433 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie15002372062571273862464test\current\58cab9.txn
2013-03-29 10:14:39,475 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@330a62e8
2013-03-29 10:14:39,477 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:14:39,477 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:14:39,477 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:14:39,478 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6331
2013-03-29 10:14:39,478 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6331
2013-03-29 10:14:39,519 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ece1410003 with negotiated timeout 10000 for client /127.0.0.1:6331
2013-03-29 10:14:39,519 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ece1410003, negotiated timeout = 10000
2013-03-29 10:14:39,520 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:14:39,537 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:14:39,538 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:14:39,538 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:14:39,539 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:14:39,539 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:14:39,540 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150034398042528159837206test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:14:39,541 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150034398042528159837206test\current\58cb26.txn
2013-03-29 10:14:39,605 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@1cdd581e
2013-03-29 10:14:39,607 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:14:39,607 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:14:39,608 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:14:39,608 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6336
2013-03-29 10:14:39,608 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6336
2013-03-29 10:14:39,627 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ece1410004 with negotiated timeout 10000 for client /127.0.0.1:6336
2013-03-29 10:14:39,627 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ece1410004, negotiated timeout = 10000
2013-03-29 10:14:39,680 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@4fa54904
2013-03-29 10:14:39,681 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:14:39,682 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:14:39,682 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:14:39,682 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6340
2013-03-29 10:14:39,683 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6340
2013-03-29 10:14:39,694 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ece1410005 with negotiated timeout 6000 for client /127.0.0.1:6340
2013-03-29 10:14:39,694 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ece1410005, negotiated timeout = 6000
2013-03-29 10:14:39,774 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ece1410005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 10:14:39,795 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ece1410005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 10:14:39,803 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ece1410005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 10:14:39,810 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ece1410005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 10:14:39,880 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ece1410005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 10:14:39,907 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 10:14:39,977 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:14:40,143 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:14:40,149 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 10:14:40,222 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 10:14:40,224 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ece1410005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 10:14:40,243 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ece1410005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 10:14:40,291 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 10:14:40,299 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 10:14:40,347 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ece1410005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 10:14:40,370 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 10:14:40,381 - INFO  [pool-17-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 10:14:40,395 - INFO  [pool-17-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 10:14:40,396 - INFO  [New I/O client worker #2-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 10:14:40,398 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 10:14:40,502 - INFO  [pool-17-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 10:14:40,606 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 10:14:41,628 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6378 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:14:41,633 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6379 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:14:41,684 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 10:14:41,684 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 10:14:41,685 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6378 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:14:41,685 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:14:41,687 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:14:41,688 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 1
2013-03-29 10:14:41,688 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1394] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x5be0aa14, /127.0.0.1:6379 => /127.0.0.1:60000]
2013-03-29 10:14:41,688 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 10:14:41,688 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1396] - Delivering: true
2013-03-29 10:14:41,690 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1445] - Resend: 99
2013-03-29 10:14:41,692 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 99
2013-03-29 10:14:41,777 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,777 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,778 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,778 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,798 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 363
2013-03-29 10:14:41,800 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1272] - Expired ConsumeSeq: 364
2013-03-29 10:14:41,804 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,805 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:14:41,805 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 1
2013-03-29 10:14:41,805 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,805 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,806 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,806 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:14:41,806 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 2
2013-03-29 10:14:41,806 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,806 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,807 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,807 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,807 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,807 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1445] - Resend: 429
2013-03-29 10:14:41,807 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1445] - Resend: 431
2013-03-29 10:14:41,822 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1304] - Duplicated consumeSeq: 434
2013-03-29 10:14:41,827 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,828 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,828 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,828 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:14:41,829 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 3
2013-03-29 10:14:41,829 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:14:41,829 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 4
2013-03-29 10:14:41,829 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,829 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,830 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,830 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,830 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,830 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,830 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,831 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,831 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,831 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1445] - Resend: 499
2013-03-29 10:14:41,836 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,836 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:14:41,836 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 5
2013-03-29 10:14:41,836 - INFO  [New I/O server worker #1-5:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 6
2013-03-29 10:14:41,837 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,837 - INFO  [New I/O server worker #1-5:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 7
2013-03-29 10:14:41,837 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,838 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,838 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 8
2013-03-29 10:14:41,838 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,838 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,838 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1252] - Resend message after one message is consumed
2013-03-29 10:14:41,839 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1445] - Resend: 522
2013-03-29 10:14:41,842 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:14:41,843 - INFO  [New I/O server worker #1-5:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 9
2013-03-29 10:14:41,843 - INFO  [New I/O server worker #1-5:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 10
2013-03-29 10:14:41,844 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:14:41,845 - INFO  [New I/O server worker #1-5:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6379 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:14:41,846 - INFO  [New I/O server worker #1-5:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:14:41,846 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:14:41,847 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1392] - cc.waitingConsumers.size() = 0
2013-03-29 10:14:41,847 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1401] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 10:14:41,847 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1403] - Last consumed seq: 496
2013-03-29 10:14:41,848 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@847] - Can't find waiting queueConsumer. Put the message in retryMessageQueue.
2013-03-29 10:14:41,848 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ActiveSubscriberState@607] - Stop delivering next message. count= 11
2013-03-29 10:14:56,514 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 10:14:56,543 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15002
2013-03-29 10:14:56,545 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15001
2013-03-29 10:14:56,547 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15003
2013-03-29 10:14:56,549 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ece1410005
2013-03-29 10:14:56,559 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ece1410005 closed
2013-03-29 10:14:56,559 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6340 which had sessionid 0x13db3ece1410005
2013-03-29 10:14:56,560 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:14:56,562 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x5b36cea3, /127.0.0.1:6345 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 10:14:56,563 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x5b36cea3, /127.0.0.1:6345 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 10:14:56,563 - INFO  [New I/O client worker #4-1:HChannelHandler@244] - Channel [id: 0x4223c011, /127.0.0.1:6364 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 10:14:56,566 - INFO  [New I/O client worker #4-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x4223c011, /127.0.0.1:6364 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 10:14:56,571 - INFO  [NIOServerFactory-15001:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:14:56,572 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ece1410001
2013-03-29 10:14:56,610 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6321 which had sessionid 0x13db3ece1410001
2013-03-29 10:14:56,611 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ece1410001 closed
2013-03-29 10:14:56,611 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:14:56,611 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:14:56,613 - WARN  [BookieJournal-15001:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:14:56,657 - INFO  [NIOServerFactory-15002:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:14:56,659 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ece1410002
2013-03-29 10:14:56,676 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6326 which had sessionid 0x13db3ece1410002
2013-03-29 10:14:56,676 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ece1410002 closed
2013-03-29 10:14:56,676 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:14:56,677 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:14:56,677 - WARN  [BookieJournal-15002:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:14:56,692 - INFO  [NIOServerFactory-15003:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:14:56,693 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ece1410003
2013-03-29 10:14:56,709 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ece1410003 closed
2013-03-29 10:14:56,710 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:14:56,710 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6331 which had sessionid 0x13db3ece1410003
2013-03-29 10:14:56,711 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:14:56,712 - WARN  [BookieJournal-15003:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:14:56,744 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ece1410004
2013-03-29 10:14:56,767 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6336 which had sessionid 0x13db3ece1410004
2013-03-29 10:14:56,767 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ece1410004 closed
2013-03-29 10:14:56,768 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 10:14:56,768 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ece1410000
2013-03-29 10:14:56,769 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:14:56,776 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6318 which had sessionid 0x13db3ece1410000
2013-03-29 10:14:56,776 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:14:56,776 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ece1410000 closed
2013-03-29 10:14:56,777 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 10:14:56,778 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@236] - Ignoring exception
java.nio.channels.ClosedChannelException
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:211)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:204)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 10:14:56,778 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 10:14:56,779 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 10:14:56,779 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 10:14:56,787 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 10:14:56,787 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 10:14:56,787 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 10:14:56,788 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 10:14:56,789 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 10:14:56,791 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:14:57,000 - INFO  [SessionTracker:SessionTrackerImpl@162] - SessionTrackerImpl exited loop!
2013-03-29 10:14:57,792 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 10:14:57,814 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
2013-03-29 10:15:09,661 - INFO  [main:HedwigHubTestBase1@158] - STARTING null
2013-03-29 10:15:09,683 - INFO  [main:PortAssignment@32] - assigning port 11221
2013-03-29 10:15:09,878 - INFO  [main:ClientBase@388] - STARTING server
2013-03-29 10:15:09,888 - INFO  [main:Environment@98] - Server environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:15:09,889 - INFO  [main:Environment@98] - Server environment:host.name=10.110.139.247
2013-03-29 10:15:09,892 - INFO  [main:Environment@98] - Server environment:java.version=1.7.0
2013-03-29 10:15:09,893 - INFO  [main:Environment@98] - Server environment:java.vendor=Oracle Corporation
2013-03-29 10:15:09,893 - INFO  [main:Environment@98] - Server environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:15:09,894 - INFO  [main:Environment@98] - Server environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:15:09,894 - INFO  [main:Environment@98] - Server environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:15:09,895 - INFO  [main:Environment@98] - Server environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:15:09,895 - INFO  [main:Environment@98] - Server environment:java.compiler=<NA>
2013-03-29 10:15:09,895 - INFO  [main:Environment@98] - Server environment:os.name=Windows 7
2013-03-29 10:15:09,896 - INFO  [main:Environment@98] - Server environment:os.arch=amd64
2013-03-29 10:15:09,896 - INFO  [main:Environment@98] - Server environment:os.version=6.1
2013-03-29 10:15:09,897 - INFO  [main:Environment@98] - Server environment:user.name=Zac
2013-03-29 10:15:09,897 - INFO  [main:Environment@98] - Server environment:user.home=C:\Users\Zac
2013-03-29 10:15:09,898 - INFO  [main:Environment@98] - Server environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:15:09,914 - INFO  [main:ZooKeeperServer@171] - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 datadir E:\test\test2303231573188141264.junit.dir\version-2 snapdir E:\test\test2303231573188141264.junit.dir\version-2
2013-03-29 10:15:09,927 - INFO  [main:NIOServerCnxnFactory@110] - binding to port 0.0.0.0/0.0.0.0:15000
2013-03-29 10:15:09,932 - INFO  [main:FileTxnSnapLog@238] - Snapshotting: 0x0 to E:\test\test2303231573188141264.junit.dir\version-2\snapshot.0
2013-03-29 10:15:09,954 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:15:09,955 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6402
2013-03-29 10:15:09,960 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@820] - Processing stat command from /127.0.0.1:6402
2013-03-29 10:15:09,963 - INFO  [Thread-2:NIOServerCnxn$StatCommand@655] - Stat command output
2013-03-29 10:15:09,963 - INFO  [Thread-2:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6402 (no session established for client)
2013-03-29 10:15:09,964 - INFO  [main:JMXEnv@133] - ensureOnly:[InMemoryDataTree, StandaloneServer_port]
2013-03-29 10:15:09,968 - INFO  [main:JMXEnv@105] - expect:InMemoryDataTree
2013-03-29 10:15:09,968 - INFO  [main:JMXEnv@108] - found:InMemoryDataTree org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=InMemoryDataTree
2013-03-29 10:15:09,969 - INFO  [main:JMXEnv@105] - expect:StandaloneServer_port
2013-03-29 10:15:09,969 - INFO  [main:JMXEnv@108] - found:StandaloneServer_port org.apache.ZooKeeperService:name0=StandaloneServer_port-1
2013-03-29 10:15:09,970 - INFO  [main:ClientBase@384] - Client test setup finished
2013-03-29 10:15:09,977 - INFO  [main:Environment@98] - Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
2013-03-29 10:15:09,978 - INFO  [main:Environment@98] - Client environment:host.name=10.110.139.247
2013-03-29 10:15:09,978 - INFO  [main:Environment@98] - Client environment:java.version=1.7.0
2013-03-29 10:15:09,979 - INFO  [main:Environment@98] - Client environment:java.vendor=Oracle Corporation
2013-03-29 10:15:09,979 - INFO  [main:Environment@98] - Client environment:java.home=C:\Program Files\Java\jdk1.7.0\jre
2013-03-29 10:15:09,980 - INFO  [main:Environment@98] - Client environment:java.class.path=C:\Users\Zac\git\msgbus\hedwig-server\target\test-classes;C:\Users\Zac\git\msgbus\hedwig-server\target\classes;E:\LocalRepository\junit\junit\4.8.1\junit-4.8.1.jar;E:\LocalRepository\org\slf4j\slf4j-api\1.6.4\slf4j-api-1.6.4.jar;E:\LocalRepository\org\slf4j\slf4j-log4j12\1.6.4\slf4j-log4j12-1.6.4.jar;C:\Users\Zac\git\msgbus\hedwig-client\target\classes;C:\Users\Zac\git\msgbus\hedwig-protocol\target\classes;E:\LocalRepository\org\jboss\netty\netty\3.2.4.Final\netty-3.2.4.Final.jar;E:\LocalRepository\commons-configuration\commons-configuration\1.6\commons-configuration-1.6.jar;E:\LocalRepository\commons-collections\commons-collections\3.2.1\commons-collections-3.2.1.jar;E:\LocalRepository\commons-lang\commons-lang\2.4\commons-lang-2.4.jar;E:\LocalRepository\commons-digester\commons-digester\1.8\commons-digester-1.8.jar;E:\LocalRepository\commons-beanutils\commons-beanutils\1.7.0\commons-beanutils-1.7.0.jar;E:\LocalRepository\commons-beanutils\commons-beanutils-core\1.8.0\commons-beanutils-core-1.8.0.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3.jar;E:\LocalRepository\org\apache\derby\derby\10.8.2.2\derby-10.8.2.2.jar;E:\LocalRepository\org\apache\zookeeper\zookeeper\3.4.3\zookeeper-3.4.3-tests.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\classes;E:\LocalRepository\com\google\protobuf\protobuf-java\2.4.1\protobuf-java-2.4.1.jar;E:\LocalRepository\com\google\guava\guava\13.0.1\guava-13.0.1.jar;E:\LocalRepository\commons-cli\commons-cli\1.2\commons-cli-1.2.jar;E:\LocalRepository\commons-codec\commons-codec\1.6\commons-codec-1.6.jar;E:\LocalRepository\commons-io\commons-io\2.1\commons-io-2.1.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\bookkeeper-server\target\test-classes;E:\LocalRepository\log4j\log4j\1.2.15\log4j-1.2.15.jar;E:\LocalRepository\jline\jline\0.9.94\jline-0.9.94.jar;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.1.0\target\classes;E:\0001 Personal Staff\PostGraduate\研二下学期\消息总线\源码修改\bookkeeper\compat-deps\hedwig-server-compat-4.0.0\target\classes;C:\Users\Zac\git\msgbus\msgbus-mq\target\classes;E:\LocalRepository\com\netflix\curator\curator-client\1.2.3\curator-client-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-framework\1.2.3\curator-framework-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-recipes\1.2.3\curator-recipes-1.2.3.jar;E:\LocalRepository\com\netflix\curator\curator-test\1.2.3\curator-test-1.2.3.jar;E:\LocalRepository\org\javassist\javassist\3.15.0-GA\javassist-3.15.0-GA.jar;E:\LocalRepository\org\apache\commons\commons-math\2.2\commons-math-2.2.jar;E:\LocalRepository\commons-logging\commons-logging\1.1.1\commons-logging-1.1.1.jar;E:\LocalRepository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/206/1/.cp/;/E:/0003 Programming/eclipse juno x64/configuration/org.eclipse.osgi/bundles/205/1/.cp/
2013-03-29 10:15:09,981 - INFO  [main:Environment@98] - Client environment:java.library.path=C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;E:\0005 Other Tools\MacType;D:\Program Files (x86)\Rational\common;D:\Program Files (x86)\Git\cmd;D:\Program Files (x86)\Git\bin;C:\Program Files (x86)\SinoVoice\jTTS 5.0 Desktop\Bin;D:\Program Files\TortoiseSVN\bin;E:\0005 Other Tools\VanDyke Software\Clients\;D:\Program Files\erl5.9.2\bin;E:\0004 OpenSource\apache-maven-3.0.1\bin;C:\Program Files\Java\jdk1.7.0\bin;.
2013-03-29 10:15:09,982 - INFO  [main:Environment@98] - Client environment:java.io.tmpdir=C:\Users\Zac\AppData\Local\Temp\
2013-03-29 10:15:09,983 - INFO  [main:Environment@98] - Client environment:java.compiler=<NA>
2013-03-29 10:15:09,983 - INFO  [main:Environment@98] - Client environment:os.name=Windows 7
2013-03-29 10:15:09,983 - INFO  [main:Environment@98] - Client environment:os.arch=amd64
2013-03-29 10:15:09,984 - INFO  [main:Environment@98] - Client environment:os.version=6.1
2013-03-29 10:15:09,984 - INFO  [main:Environment@98] - Client environment:user.name=Zac
2013-03-29 10:15:09,984 - INFO  [main:Environment@98] - Client environment:user.home=C:\Users\Zac
2013-03-29 10:15:09,984 - INFO  [main:Environment@98] - Client environment:user.dir=C:\Users\Zac\git\msgbus\hedwig-server
2013-03-29 10:15:09,986 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=30000 watcher=org.apache.zookeeper.test.ClientBase$CountdownWatcher@6ab30eb5
2013-03-29 10:15:09,999 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:15:10,003 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:15:10,003 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6405
2013-03-29 10:15:10,003 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:15:10,007 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6405
2013-03-29 10:15:10,009 - INFO  [SyncThread:0:FileTxnLog@199] - Creating new log file: log.1
2013-03-29 10:15:10,055 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ed5b720000 with negotiated timeout 30000 for client /127.0.0.1:6405
2013-03-29 10:15:10,055 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ed5b720000, negotiated timeout = 30000
2013-03-29 10:15:10,060 - INFO  [main:JMXEnv@105] - expect:0x13db3ed5b720000
2013-03-29 10:15:10,060 - INFO  [main:JMXEnv@108] - found:0x13db3ed5b720000 org.apache.ZooKeeperService:name0=StandaloneServer_port-1,name1=Connections,name2=127.0.0.1,name3=0x13db3ed5b720000
2013-03-29 10:15:10,157 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@f98c4b6
2013-03-29 10:15:10,162 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:15:10,162 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:15:10,163 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:15:10,163 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6408
2013-03-29 10:15:10,163 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6408
2013-03-29 10:15:10,170 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ed5b720001 with negotiated timeout 10000 for client /127.0.0.1:6408
2013-03-29 10:15:10,170 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ed5b720001, negotiated timeout = 10000
2013-03-29 10:15:10,173 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:15:10,320 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:15:10,335 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:15:10,335 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:15:10,340 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:15:10,340 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:15:10,343 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150016810423342429986543test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:15:10,349 - INFO  [BookieJournal-15001:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150016810423342429986543test\current\59437c.txn
2013-03-29 10:15:10,408 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@397f2a20
2013-03-29 10:15:10,411 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:15:10,412 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:15:10,413 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:15:10,422 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6414
2013-03-29 10:15:10,423 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6414
2013-03-29 10:15:10,465 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ed5b720002 with negotiated timeout 10000 for client /127.0.0.1:6414
2013-03-29 10:15:10,465 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ed5b720002, negotiated timeout = 10000
2013-03-29 10:15:10,466 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:15:10,526 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:15:10,529 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:15:10,529 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:15:10,531 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:15:10,531 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:15:10,532 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150023725729842220619691test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:15:10,535 - INFO  [BookieJournal-15002:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150023725729842220619691test\current\594438.txn
2013-03-29 10:15:10,595 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.bookie.Bookie$6@71c8006a
2013-03-29 10:15:10,596 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:15:10,597 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:15:10,597 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6419
2013-03-29 10:15:10,597 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:15:10,598 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6419
2013-03-29 10:15:10,711 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ed5b720003 with negotiated timeout 10000 for client /127.0.0.1:6419
2013-03-29 10:15:10,711 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ed5b720003, negotiated timeout = 10000
2013-03-29 10:15:10,714 - WARN  [main:Bookie@494] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2013-03-29 10:15:10,737 - INFO  [main:Bookie@527] - instantiate ledger manager org.apache.bookkeeper.meta.FlatLedgerManagerFactory
2013-03-29 10:15:10,739 - INFO  [main:LedgerCacheImpl@73] - maxMemory = 878051328
2013-03-29 10:15:10,739 - INFO  [main:LedgerCacheImpl@74] - openFileLimit is 900, pageSize is 8192, pageLimit is 35728
2013-03-29 10:15:10,740 - INFO  [main:GarbageCollectorThread@246] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2013-03-29 10:15:10,740 - INFO  [main:GarbageCollectorThread@248] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2013-03-29 10:15:10,741 - ERROR [main:Journal$LastLogMark@177] - Problems reading from C:\Users\Zac\AppData\Local\Temp\bookie150036230970505738285184test\current\lastMark (this is okay if it is the first time starting this bookie
2013-03-29 10:15:10,743 - INFO  [BookieJournal-15003:JournalChannel@66] - Opening journal C:\Users\Zac\AppData\Local\Temp\bookie150036230970505738285184test\current\594507.txn
2013-03-29 10:15:10,790 - INFO  [main:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@68fc5a6c
2013-03-29 10:15:10,791 - INFO  [main-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:15:10,792 - INFO  [main-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:15:10,792 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:15:10,792 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6424
2013-03-29 10:15:10,793 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6424
2013-03-29 10:15:10,828 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ed5b720004 with negotiated timeout 10000 for client /127.0.0.1:6424
2013-03-29 10:15:10,828 - INFO  [main-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ed5b720004, negotiated timeout = 10000
2013-03-29 10:15:10,876 - INFO  [Thread-7:ZooKeeper@433] - Initiating client connection, connectString=127.0.0.1:15000 sessionTimeout=2000 watcher=org.apache.hedwig.server.netty.PubSubServer$1@30d6defa
2013-03-29 10:15:10,877 - INFO  [Thread-7-SendThread():ClientCnxn$SendThread@933] - Opening socket connection to server /127.0.0.1:15000
2013-03-29 10:15:10,878 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ZooKeeperSaslClient@125] - Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
2013-03-29 10:15:10,878 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@846] - Socket connection established to 127.0.0.1/127.0.0.1:15000, initiating session
2013-03-29 10:15:10,879 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@213] - Accepted socket connection from /127.0.0.1:6427
2013-03-29 10:15:10,879 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:ZooKeeperServer@838] - Client attempting to establish new session at /127.0.0.1:6427
2013-03-29 10:15:10,886 - INFO  [SyncThread:0:ZooKeeperServer@604] - Established session 0x13db3ed5b720005 with negotiated timeout 6000 for client /127.0.0.1:6427
2013-03-29 10:15:10,886 - INFO  [Thread-7-SendThread(127.0.0.1:15000):ClientCnxn$SendThread@1175] - Session establishment complete on server 127.0.0.1/127.0.0.1:15000, sessionid = 0x13db3ed5b720005, negotiated timeout = 6000
2013-03-29 10:15:10,973 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ed5b720005 type:create cxid:0x2 zxid:0x12 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers/METADATA Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers/METADATA
2013-03-29 10:15:10,979 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ed5b720005 type:create cxid:0x3 zxid:0x13 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/managers Error:KeeperErrorCode = NoNode for /hedwig/standalone/managers
2013-03-29 10:15:10,986 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ed5b720005 type:create cxid:0x4 zxid:0x14 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone Error:KeeperErrorCode = NoNode for /hedwig/standalone
2013-03-29 10:15:10,994 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ed5b720005 type:create cxid:0x5 zxid:0x15 txntype:-1 reqpath:n/a Error Path:/hedwig Error:KeeperErrorCode = NoNode for /hedwig
2013-03-29 10:15:11,062 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ed5b720005 type:create cxid:0xb zxid:0x1b txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/hosts Error:KeeperErrorCode = NoNode for /hedwig/standalone/hosts
2013-03-29 10:15:11,088 - INFO  [Thread-7-EventThread:ZkTopicManager$2@103] - Successfully registered hub hostname: "10.110.139.247:60000:60001"
czxid: 29
 with zookeeper
2013-03-29 10:15:11,157 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:15:11,332 - INFO  [Thread-7:PubSubServer@265] - Going into receive loop
2013-03-29 10:15:11,339 - INFO  [main:HedwigHubTestBase1@162] - HedwigHub test setup finished
2013-03-29 10:15:11,418 - INFO  [Thread-7-EventThread:ZkTopicManager$ZkGetOwnerOp$1@165] - 10.110.139.247:60000:60001 : Least loaded owner hostname: "10.110.139.247:60000:60001"
czxid: 29
 is chosen for topic messageQueue-test
2013-03-29 10:15:11,420 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ed5b720005 type:create cxid:0x16 zxid:0x1e txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test
2013-03-29 10:15:11,436 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ed5b720005 type:create cxid:0x17 zxid:0x1f txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics
2013-03-29 10:15:11,475 - INFO  [Thread-7-EventThread:BookkeeperPersistenceManager$AcquireOp@874] - Process 0 ledgers for topic messageQueue-test starting from seq id 1.
2013-03-29 10:15:11,483 - INFO  [Thread-7-EventThread:AbstractSubscriptionManager$AcquireOp$1$1@266] - Subscription manager successfully acquired topic: messageQueue-test
2013-03-29 10:15:11,521 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@617] - Got user-level KeeperException when processing sessionid:0x13db3ed5b720005 type:create cxid:0x20 zxid:0x26 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics/messageQueue-test/subscribers Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics/messageQueue-test/subscribers
2013-03-29 10:15:11,545 - INFO  [Thread-7-EventThread:CallbackUtils$3@148] - [standalone] all cross-region subscriptions succeeded
2013-03-29 10:15:11,557 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15003
2013-03-29 10:15:11,574 - INFO  [pool-15-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15001
2013-03-29 10:15:11,578 - INFO  [New I/O client worker #2-1:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15003
2013-03-29 10:15:11,578 - INFO  [New I/O client worker #2-2:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15001
2013-03-29 10:15:11,650 - INFO  [pool-16-thread-1:PerChannelBookieClient@117] - Connecting to bookie: /10.110.139.247:15002
2013-03-29 10:15:11,680 - INFO  [New I/O client worker #2-3:PerChannelBookieClient$1@137] - Successfully connected to bookie: /10.110.139.247:15002
2013-03-29 10:15:12,474 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6465 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:15:12,479 - INFO  [DeliveryManagerThread:SubscribeHandler$1$1@206] - Subscribe request (2) for (topic:messageQueue-test, subscriber:@q_subid) from channel /127.0.0.1:6464 succeed - its subscription data is State : { consumeSeqId: local:0 };Preferences : { System Preferences : [] };
2013-03-29 10:15:12,530 - INFO  [Thread-12:HedwigClientImpl@112] - Stopping the client!
2013-03-29 10:15:12,530 - INFO  [Thread-12:AbstractHChannelManager@607] - Shutting down the channels manager.
2013-03-29 10:15:12,531 - INFO  [New I/O server worker #1-5:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6464 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:15:12,532 - INFO  [New I/O server worker #1-5:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:15:12,533 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:15:12,533 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1391] - cc.waitingConsumers.size() = 1
2013-03-29 10:15:12,533 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1393] - One channel disconnected, but still, there're consumers waiting for msg. [id: 0x3394ef9f, /127.0.0.1:6465 => /127.0.0.1:60000]
2013-03-29 10:15:12,534 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1395] - Delivering: true
2013-03-29 10:15:12,534 - ERROR [New I/O client worker #5-2:HChannelHandler@290] - Exception caught on client channel
java.nio.channels.ClosedChannelException
	at sun.nio.ch.SocketChannelImpl.ensureWriteOpen(SocketChannelImpl.java:249)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:440)
	at org.jboss.netty.channel.socket.nio.SocketSendBufferPool$PooledSendBuffer.transferTo(SocketSendBufferPool.java:239)
	at org.jboss.netty.channel.socket.nio.NioWorker.write0(NioWorker.java:469)
	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:387)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink.eventSunk(NioClientSocketPipelineSink.java:117)
	at org.jboss.netty.channel.Channels.write(Channels.java:632)
	at org.jboss.netty.handler.codec.oneone.OneToOneEncoder.handleDownstream(OneToOneEncoder.java:70)
	at org.jboss.netty.channel.Channels.write(Channels.java:632)
	at org.jboss.netty.handler.codec.oneone.OneToOneEncoder.handleDownstream(OneToOneEncoder.java:70)
	at org.jboss.netty.channel.Channels.write(Channels.java:611)
	at org.jboss.netty.channel.Channels.write(Channels.java:578)
	at org.jboss.netty.channel.AbstractChannel.write(AbstractChannel.java:259)
	at org.apache.hedwig.client.netty.impl.ActiveSubscriber.consume(ActiveSubscriber.java:298)
	at org.apache.hedwig.client.netty.impl.AbstractSubscribeResponseHandler.consume(AbstractSubscribeResponseHandler.java:341)
	at org.apache.hedwig.client.netty.HedwigSubscriber.consume(HedwigSubscriber.java:326)
	at com.yonyou.msgbus.client.MessageQueueClient.consumeMessage(MessageQueueClient.java:148)
	at org.apache.hedwig.server.test.Tools$1.deliver(Tools.java:69)
	at com.yonyou.msgbus.client.MessageQueueClient$4.deliver(MessageQueueClient.java:170)
	at org.apache.hedwig.client.netty.impl.ActiveSubscriber.unsafeDeliverMessage(ActiveSubscriber.java:257)
	at org.apache.hedwig.client.netty.impl.simple.SimpleSubscribeResponseHandler$SimpleActiveSubscriber.unsafeDeliverMessage(SimpleSubscribeResponseHandler.java:101)
	at org.apache.hedwig.client.netty.impl.ActiveSubscriber.asyncMessageDeliver(ActiveSubscriber.java:244)
	at org.apache.hedwig.client.netty.impl.ActiveSubscriber.handleMessage(ActiveSubscriber.java:207)
	at org.apache.hedwig.client.netty.impl.simple.SimpleSubscribeResponseHandler.handleSubscribeMessage(SimpleSubscribeResponseHandler.java:236)
	at org.apache.hedwig.client.netty.impl.HChannelHandler.messageReceived(HChannelHandler.java:133)
	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)
	at org.jboss.netty.handler.codec.oneone.OneToOneDecoder.handleUpstream(OneToOneDecoder.java:76)
	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)
	at org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:317)
	at org.jboss.netty.handler.codec.frame.FrameDecoder.callDecode(FrameDecoder.java:299)
	at org.jboss.netty.handler.codec.frame.FrameDecoder.messageReceived(FrameDecoder.java:216)
	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274)
	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261)
	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:349)
	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:280)
	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:200)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
	at java.lang.Thread.run(Thread.java:722)
2013-03-29 10:15:12,534 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1444] - Resend: 102
2013-03-29 10:15:12,535 - ERROR [New I/O client worker #5-2:ActiveSubscriber$1@303] - Error writing a Consume request to channel: [id: 0x1012b3e8, /0:0:0:0:0:0:0:0:6464 :> /127.0.0.1:60000] with messageSeqId: localComponent: 102
 for Topic: messageQueue-test, SubscriberId: @q_subid
2013-03-29 10:15:12,535 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ResendRequest@1444] - Resend: 104
2013-03-29 10:15:12,536 - WARN  [New I/O client worker #5-2:MessageConsumeCallback@88] - No subscription Topic: messageQueue-test, SubscriberId: @q_subid found to consume message local:102.
2013-03-29 10:15:12,537 - INFO  [Thread-12:HedwigClientImpl@122] - Completed stopping the client!
2013-03-29 10:15:12,538 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1271] - Expired ConsumeSeq: 104
2013-03-29 10:15:12,584 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:15:12,669 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:15:12,671 - INFO  [DeliveryManagerThread:FIFODeliveryManager$AsyncSendingQueueMessage@882] - After this message sent out, there remains no waiting consumer.
2013-03-29 10:15:12,671 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1239] - Try to wake up subscriber to deliver messages again.
2013-03-29 10:15:12,675 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1271] - Expired ConsumeSeq: 283
2013-03-29 10:15:12,676 - INFO  [DeliveryManagerThread:FIFODeliveryManager$ConsumerCluster@1271] - Expired ConsumeSeq: 283
2013-03-29 10:15:12,759 - INFO  [New I/O server worker #1-4:SubscriptionChannelManager@98] - Subscription channel /127.0.0.1:6465 for Topic: messageQueue-test, SubscriberId: @q_subid is disconnected.
2013-03-29 10:15:12,759 - INFO  [New I/O server worker #1-4:FIFODeliveryManager@1016] - On channel disconnected
2013-03-29 10:15:12,760 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:15:12,761 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:15:12,761 - INFO  [DeliveryManagerThread:FIFODeliveryManager$QueueConsumer@1108] - PermanentError!
2013-03-29 10:15:12,762 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1391] - cc.waitingConsumers.size() = 0
2013-03-29 10:15:12,762 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1400] - Subscriber Topic: messageQueue-test, SubscriberId: @q_subid will be removed.
2013-03-29 10:15:12,762 - INFO  [DeliveryManagerThread:FIFODeliveryManager$RemoveChannelForQueueRequest@1402] - Last consumed seq: 496
2013-03-29 10:15:27,368 - INFO  [main:HedwigHubTestBase1@168] - tearDown starting
2013-03-29 10:15:27,402 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15002
2013-03-29 10:15:27,404 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15001
2013-03-29 10:15:27,405 - INFO  [main:PerChannelBookieClient@472] - Disconnected from bookie: /10.110.139.247:15003
2013-03-29 10:15:27,407 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ed5b720005
2013-03-29 10:15:27,418 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ed5b720005 closed
2013-03-29 10:15:27,418 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6427 which had sessionid 0x13db3ed5b720005
2013-03-29 10:15:27,419 - INFO  [Thread-7-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:15:27,425 - INFO  [New I/O client worker #3-1:HChannelHandler@244] - Channel [id: 0x1879d52f, /127.0.0.1:6432 :> localhost/127.0.0.1:60000] was disconnected to host localhost/127.0.0.1:60000.
2013-03-29 10:15:27,425 - INFO  [New I/O client worker #3-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x1879d52f, /127.0.0.1:6432 :> localhost/127.0.0.1:60000] to localhost/127.0.0.1:60000 disconnected.
2013-03-29 10:15:27,426 - INFO  [New I/O client worker #4-1:HChannelHandler@244] - Channel [id: 0x4bd3db5c, /127.0.0.1:6451 :> /127.0.0.1:60000] was disconnected to host /127.0.0.1:60000.
2013-03-29 10:15:27,426 - INFO  [New I/O client worker #4-1:AbstractHChannelManager@363] - NonSubscription Channel [id: 0x4bd3db5c, /127.0.0.1:6451 :> /127.0.0.1:60000] to /127.0.0.1:60000 disconnected.
2013-03-29 10:15:27,436 - INFO  [NIOServerFactory-15001:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:15:27,439 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ed5b720001
2013-03-29 10:15:27,443 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6408 which had sessionid 0x13db3ed5b720001
2013-03-29 10:15:27,443 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:15:27,443 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ed5b720001 closed
2013-03-29 10:15:27,445 - INFO  [Thread-4:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:15:27,445 - WARN  [BookieJournal-15001:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:15:27,478 - WARN  [NIOServerFactory-15002:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.ClosedChannelException
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:211)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:146)
2013-03-29 10:15:27,478 - INFO  [NIOServerFactory-15002:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:15:27,479 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ed5b720002
2013-03-29 10:15:27,501 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ed5b720002 closed
2013-03-29 10:15:27,502 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:15:27,502 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6414 which had sessionid 0x13db3ed5b720002
2013-03-29 10:15:27,502 - INFO  [Thread-5:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:15:27,503 - WARN  [BookieJournal-15002:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:15:27,524 - WARN  [NIOServerFactory-15003:NIOServerFactory@159] - Exception in server socket loop: /0:0:0:0:0:0:0:0
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.bookkeeper.proto.NIOServerFactory.run(NIOServerFactory.java:145)
2013-03-29 10:15:27,525 - INFO  [NIOServerFactory-15003:NIOServerFactory@162] - NIOServerCnxn factory exitedloop.
2013-03-29 10:15:27,525 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ed5b720003
2013-03-29 10:15:27,543 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ed5b720003 closed
2013-03-29 10:15:27,543 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6419 which had sessionid 0x13db3ed5b720003
2013-03-29 10:15:27,543 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:15:27,544 - INFO  [Thread-6:LedgerDirsManager$LedgerDirsMonitor@212] - LedgerDirsMonitor thread is interrupted
2013-03-29 10:15:27,544 - WARN  [BookieJournal-15003:Journal@549] - Journal exits when shutting down
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2052)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.bookkeeper.bookie.Journal.run(Journal.java:497)
2013-03-29 10:15:27,575 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ed5b720004
2013-03-29 10:15:27,593 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ed5b720004 closed
2013-03-29 10:15:27,593 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6424 which had sessionid 0x13db3ed5b720004
2013-03-29 10:15:27,593 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:15:27,594 - INFO  [main:ClientBase@425] - tearDown starting
2013-03-29 10:15:27,595 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@466] - Processed session termination for sessionid: 0x13db3ed5b720000
2013-03-29 10:15:27,601 - INFO  [main:ZooKeeper@679] - Session: 0x13db3ed5b720000 closed
2013-03-29 10:15:27,601 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxn@1000] - Closed socket connection for client /127.0.0.1:6405 which had sessionid 0x13db3ed5b720000
2013-03-29 10:15:27,601 - INFO  [main-EventThread:ClientCnxn$EventThread@511] - EventThread shut down
2013-03-29 10:15:27,602 - INFO  [main:ClientBase@395] - STOPPING server
2013-03-29 10:15:27,603 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:15000:NIOServerCnxnFactory@240] - NIOServerCnxn factory exited run method
2013-03-29 10:15:27,603 - INFO  [main:ZooKeeperServer@428] - shutting down
2013-03-29 10:15:27,604 - INFO  [main:SessionTrackerImpl@220] - Shutting down
2013-03-29 10:15:27,604 - INFO  [main:PrepRequestProcessor@733] - Shutting down
2013-03-29 10:15:27,604 - INFO  [main:SyncRequestProcessor@173] - Shutting down
2013-03-29 10:15:27,604 - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@135] - PrepRequestProcessor exited loop!
2013-03-29 10:15:27,605 - INFO  [SyncThread:0:SyncRequestProcessor@155] - SyncRequestProcessor exited!
2013-03-29 10:15:27,605 - INFO  [main:FinalRequestProcessor@414] - shutdown of request processor complete
2013-03-29 10:15:27,607 - INFO  [main:FourLetterWordMain@43] - connecting to 127.0.0.1 15000
2013-03-29 10:15:28,617 - INFO  [main:JMXEnv@133] - ensureOnly:[]
2013-03-29 10:15:28,620 - INFO  [main:HedwigHubTestBase1@171] - FINISHED null
